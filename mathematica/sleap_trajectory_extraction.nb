(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    190159,       3837]
NotebookOptionsPosition[    185086,       3751]
NotebookOutlinePosition[    185462,       3767]
CellTagsIndexPosition[    185419,       3764]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.8431241293644314`*^9, 
  3.8431241300034456`*^9}},ExpressionUUID->"dcbafb6b-b5d1-4aef-a1af-\
e08110c8a072"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xmax", "=", "656"}], ";", 
  RowBox[{"ymax", "=", "648"}], ";"}]], "Input",
 CellChangeTimes->{{3.847463663269393*^9, 
  3.847463671568802*^9}},ExpressionUUID->"9f4752f4-7cb7-4a36-8aa3-\
c8420979ee27"],

Cell[CellGroupData[{

Cell["Directory setup", "Subsection",
 CellChangeTimes->{{3.8423660748800054`*^9, 
  3.842366076399544*^9}},ExpressionUUID->"46a17531-5b19-4860-9496-\
e39ec32aacc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Silence", " ", "warning", " ", "for", " ", "NaN", " ", "values"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetSystemOptions", "[", 
     RowBox[{"\"\<LibraryLinkOptions\>\"", "\[Rule]", 
      RowBox[{"\"\<TestFloatingPointExceptions\>\"", "\[Rule]", "False"}]}], 
     "]"}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8438110096577463`*^9, 3.843811022406262*^9}, {
  3.8448552338331404`*^9, 
  3.8448552368751416`*^9}},ExpressionUUID->"f0f9a852-5092-4a41-be8c-\
94481b2c9e8c"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:/Users/user/Desktop/Coding/ant/data/sleap\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.842694579046344*^9, 3.842694579586748*^9}, {
  3.843121407598874*^9, 3.8431214105741553`*^9}, {3.8448552528163137`*^9, 
  3.8448552530411663`*^9}},ExpressionUUID->"25ce2295-9b5f-4d54-8802-\
4cbc1ea62308"],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<testset.hdf5\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.843810811446166*^9, 
  3.8438108147270927`*^9}},ExpressionUUID->"0ba2456c-30c4-4aae-9952-\
15dc3327f819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"src", "=", 
   RowBox[{
   "file", "\[LeftDoubleBracket]", "\"\</trajectory_0\>\"", 
    "\[RightDoubleBracket]"}]}], ";"}]], "Input",ExpressionUUID->"d729cc21-\
48c1-46a2-a5b0-c10f73cfbbf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imgsize", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{"xmax", ",", "ymax"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"scalefactor", "=", 
  FractionBox["imgsize", "17.5"], 
  RowBox[{"(*", 
   RowBox[{"pixels", " ", "per", " ", "cm"}], "*)"}]}]}], "Input",ExpressionUU\
ID->"1e238cbe-e63c-464e-8c4b-a74e3d7ac8b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Helper function", "Subsection",ExpressionUUID->"d2ca4549-765b-46dd-bd72-f64b1f72cdc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcCos2", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ans", ",", "temp", ",", "norm"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"norm", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "<", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ans", "=", 
        RowBox[{"ArcCos", "[", 
         FractionBox["x", "norm"], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ans", "=", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           FractionBox["x", "norm"], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ans", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.842346866849598*^9, 3.842346876097384*^9}, {
  3.84236518396154*^9, 3.8423651875829053`*^9}, {3.8423652309033084`*^9, 
  3.8423652347182007`*^9}, {3.8423653283010783`*^9, 3.8423654268685365`*^9}, {
  3.8423665558254576`*^9, 3.8423665566730022`*^9}, {3.8423666212731056`*^9, 
  3.8423666220649323`*^9}},ExpressionUUID->"5104f5ad-d60e-4f4d-a5bb-\
c13dcd473a13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OriAnt", "[", 
   RowBox[{"ultim_", ",", "penultim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "y1", ",", "x2", ",", "y2", ",", "dx", ",", "dy", ",", "norm",
       ",", "angle"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "=", 
      RowBox[{
      "penultim", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"x2", "=", 
      RowBox[{
      "ultim", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{
      "penultim", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{
      "ultim", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dx", "=", 
      RowBox[{"x2", "-", "x1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dy", "=", 
      RowBox[{"y2", "-", "y1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norm", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["dx", "2"], "+", 
         SuperscriptBox["dy", "2"]}], "]"}], "+", "0.0001"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcCos2", "[", 
       RowBox[{
        FractionBox["dx", "norm"], ",", 
        FractionBox["dy", "norm"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "angle", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8423471139494376`*^9, 3.8423471486279364`*^9}, {
   3.8423472273970437`*^9, 3.842347281285342*^9}, 
   3.842348259137493*^9},ExpressionUUID->"579f54c2-c2f2-40ca-a66a-\
4e4c393d2d2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probability Distribution Functions", "Subsection",
 CellChangeTimes->{{3.8460823147490344`*^9, 
  3.846082334959545*^9}},ExpressionUUID->"5534d867-59e6-48ef-be4a-\
086d7d496005"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Necessary", " ", "for", " ", "computing", " ", "probability", " ", 
   "assigned", " ", "with", " ", "step", " ", "coordinate", " ", 
   RowBox[{"pairs", ".", " ", "Functions"}], " ", "were", " ", "generated", 
   " ", "from", " ", "unconditioned", " ", "single", " ", "ant", " ", 
   RowBox[{"data", ".", " ", "With"}], " ", "more", " ", "data", " ", "this", 
   " ", "should", " ", "be", " ", "elaborated", " ", "to", " ", "conditional",
    " ", "probability", " ", "to", " ", "provide", " ", "better", " ", 
   RowBox[{"prediction", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8460823367004642`*^9, 
  3.8460824335433187`*^9}},ExpressionUUID->"dd480c16-9207-4112-a2f3-\
f23598b15bd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deltaspeed", "=", 
   InterpretationBox[
    RowBox[{
     TagBox["DataDistribution",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               GraphicsComplexBox[CompressedData["
1:eJw1029Q03UABvCx0QloC2GIZM2IZZpyWngwzXp+40x0ynHzijjhTAUOQ2Ge
NDTpDhaIyATGAbdQTnGEMFRErAHN+EJ0cyo7jiHCwQZj/vhbLWCDBey26gUv
nnvu8+J5+QSfEh9NZjIYjPD/8n8H17RMud0rJO87/pGDDgoHgqLGoxuWCWvm
FsegOoq4veU+IxFLRKjgvajnJ+EQJStYNjlIjiU0dParDHDTTEujhYuE90y+
89l2Kcz7/ypbs2mBdF6vqOmmiyD1qMvXdNnIsTMxYXN3FPD9mqt8GDNP7HUL
ebEJSnzvmG06Z5klbXi4Z9dwA+r6h3Zd3PQ3mXCveb71ZDN4fjGiMv6fJLvQ
WmUYaMWJjYEhT/KniXdNKfsSTZB0tmL4mmWC1KWYFTOmLkRuKBl/6UkTXsiX
JZN1OoxeNVbviRsj81nnZydVety9I4wX0EYydEzBWj/Si/f7D0aGhQ0QSs4Z
zA3txzsKqyyW7iVD5mz967mDqPLeMOf5mY6kStr9Tu83gg7ctzl7rYZchX/H
gnoUvvHhghavYrLt7cssQckYLH77gn576xHW+finPZiyoFLE0M3wf0euzt91
X/MKcZGSTxKf9oDVmXw9kkGDna/PfCzsx/wj17uOolc42ZMhrakYgvCs0xmQ
bkGOutTesc2MTJ4tl5tnhlwTcEExYAEMlm+9rhihTeXWT7ePY0wm1vYJBrC7
+9y86ocpuIYnuAXJBtCJYplI8AcEVeWZ29P0aKudN3wTYgX3NamNw9Nhil36
E1JnEXWNzW/fqIXvj9HrnJo5eKgaEp43ayEsPvJx5gc2yEW1XrfVT1Fbdnt9
Uo4dv7S9vGgb0cPfyidv2BZwP0ejMwt7oUzcwtkZ7YDxhk+41WlAdHOr5HL1
P2j8+UErs6UPa2OLGit9l7HFk5l1ZUcfZjitxcGnV+AoEkQFSHoxvPW9AylG
J44rlV3MvXpMB0T40IdcEPPYbxY0aRHIvSV5cdONSu/O5YqmDtz7lZcgKGBQ
J2TnIwY2q2Fa4okMuz2oD099+rnefRdVygvdLpMHtTj4xaJUVY1xyZmwwgom
FX/vifKGrBTtsT7pPRSL4sgngw7TUsh74+1uN4s6/pG6XrySjvDspsd9lJ1k
cRqjxi6Vo0qzIyIlg0mtevU/q17dr/pfEHq+aA==
                "], {{{
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    PolygonBox[{{50, 54, 52, 48, 49}}], 
                    PolygonBox[{{51, 53, 1, 2, 3, 4, 5, 6}}]}]}, {
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    
                    PolygonBox[{{51, 52, 47, 46, 45, 44, 43, 42, 41, 40, 39, 
                    38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 
                    24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 
                    10, 9, 8, 7}}]}]}, {}, {}}, {{}, {}, {
                   Directive[
                    Opacity[1.], 
                    GrayLevel[0.55], 
                    AbsoluteThickness[1.5]], 
                   
                   LineBox[{1, 2, 3, 4, 5, 6, 51, 7, 8, 9, 10, 11, 12, 13, 14,
                     15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 
                    43, 44, 45, 46, 47, 52, 48, 49, 50}]}}}], {
               DisplayFunction -> Identity, AspectRatio -> 1, 
                Axes -> {False, False}, AxesLabel -> {None, None}, 
                AxesOrigin -> {0, 0.02}, Background -> GrayLevel[0.93], 
                BaseStyle -> {FontFamily -> "Arial"}, DisplayFunction :> 
                Identity, Frame -> {{True, True}, {True, True}}, 
                FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
                Directive[
                  Thickness[Tiny], 
                  GrayLevel[0.7]], FrameTicks -> {{None, None}, {None, None}},
                 GridLines -> {None, None}, GridLinesStyle -> Directive[
                  GrayLevel[0.5, 0.4]], ImageSize -> {Automatic, 
                  Dynamic[
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])]}, LabelStyle -> {FontFamily -> "Arial"}, 
                Method -> {"ScalingFunctions" -> None, "AxesInFront" -> True},
                 PlotRange -> {All, All}, PlotRangeClipping -> True, 
                PlotRangePadding -> {{0, 0}, {0, 0.1}}, 
                Ticks -> {Automatic, Automatic}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"SmoothKernel\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Data points: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["17999", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               GraphicsComplexBox[CompressedData["
1:eJw1029Q03UABvCx0QloC2GIZM2IZZpyWngwzXp+40x0ynHzijjhTAUOQ2Ge
NDTpDhaIyATGAbdQTnGEMFRErAHN+EJ0cyo7jiHCwQZj/vhbLWCDBey26gUv
nnvu8+J5+QSfEh9NZjIYjPD/8n8H17RMud0rJO87/pGDDgoHgqLGoxuWCWvm
FsegOoq4veU+IxFLRKjgvajnJ+EQJStYNjlIjiU0dParDHDTTEujhYuE90y+
89l2Kcz7/ypbs2mBdF6vqOmmiyD1qMvXdNnIsTMxYXN3FPD9mqt8GDNP7HUL
ebEJSnzvmG06Z5klbXi4Z9dwA+r6h3Zd3PQ3mXCveb71ZDN4fjGiMv6fJLvQ
WmUYaMWJjYEhT/KniXdNKfsSTZB0tmL4mmWC1KWYFTOmLkRuKBl/6UkTXsiX
JZN1OoxeNVbviRsj81nnZydVety9I4wX0EYydEzBWj/Si/f7D0aGhQ0QSs4Z
zA3txzsKqyyW7iVD5mz967mDqPLeMOf5mY6kStr9Tu83gg7ctzl7rYZchX/H
gnoUvvHhghavYrLt7cssQckYLH77gn576xHW+finPZiyoFLE0M3wf0euzt91
X/MKcZGSTxKf9oDVmXw9kkGDna/PfCzsx/wj17uOolc42ZMhrakYgvCs0xmQ
bkGOutTesc2MTJ4tl5tnhlwTcEExYAEMlm+9rhihTeXWT7ePY0wm1vYJBrC7
+9y86ocpuIYnuAXJBtCJYplI8AcEVeWZ29P0aKudN3wTYgX3NamNw9Nhil36
E1JnEXWNzW/fqIXvj9HrnJo5eKgaEp43ayEsPvJx5gc2yEW1XrfVT1Fbdnt9
Uo4dv7S9vGgb0cPfyidv2BZwP0ejMwt7oUzcwtkZ7YDxhk+41WlAdHOr5HL1
P2j8+UErs6UPa2OLGit9l7HFk5l1ZUcfZjitxcGnV+AoEkQFSHoxvPW9AylG
J44rlV3MvXpMB0T40IdcEPPYbxY0aRHIvSV5cdONSu/O5YqmDtz7lZcgKGBQ
J2TnIwY2q2Fa4okMuz2oD099+rnefRdVygvdLpMHtTj4xaJUVY1xyZmwwgom
FX/vifKGrBTtsT7pPRSL4sgngw7TUsh74+1uN4s6/pG6XrySjvDspsd9lJ1k
cRqjxi6Vo0qzIyIlg0mtevU/q17dr/pfEHq+aA==
                "], {{{
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    PolygonBox[{{50, 54, 52, 48, 49}}], 
                    PolygonBox[{{51, 53, 1, 2, 3, 4, 5, 6}}]}]}, {
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    
                    PolygonBox[{{51, 52, 47, 46, 45, 44, 43, 42, 41, 40, 39, 
                    38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 
                    24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 
                    10, 9, 8, 7}}]}]}, {}, {}}, {{}, {}, {
                   Directive[
                    Opacity[1.], 
                    GrayLevel[0.55], 
                    AbsoluteThickness[1.5]], 
                   LineBox[{1, 2, 3, 4, 5, 6, 51, 7, 8, 9, 10, 11, 12, 13, 14,
                     15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 
                    43, 44, 45, 46, 47, 52, 48, 49, 50}]}}}], {
               DisplayFunction -> Identity, AspectRatio -> 1, 
                Axes -> {False, False}, AxesLabel -> {None, None}, 
                AxesOrigin -> {0, 0.02}, Background -> GrayLevel[0.93], 
                BaseStyle -> {FontFamily -> "Arial"}, DisplayFunction :> 
                Identity, Frame -> {{True, True}, {True, True}}, 
                FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
                Directive[
                  Thickness[Tiny], 
                  GrayLevel[0.7]], FrameTicks -> {{None, None}, {None, None}},
                 GridLines -> {None, None}, GridLinesStyle -> Directive[
                  GrayLevel[0.5, 0.4]], ImageSize -> {Automatic, 
                  Dynamic[
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])]}, LabelStyle -> {FontFamily -> "Arial"}, 
                Method -> {"ScalingFunctions" -> None, "AxesInFront" -> True},
                 PlotRange -> {All, All}, PlotRangeClipping -> True, 
                PlotRangePadding -> {{0, 0}, {0, 0.1}}, 
                Ticks -> {Automatic, Automatic}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"SmoothKernel\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Data points: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["17999", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Input dimension: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "39.67868768520105`"}], ",", 
                    "30.767519852280206`"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Bandwidth: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.5316442933530237`", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel",
       DisplayFunction->(
        ButtonBox[#, Active -> False, Alignment -> Left, 
         Appearance -> {
          "Default" -> 
           FrontEnd`FileName[{"Typeset", "SummaryBox"}, "Panel.9.png"]}, 
         FrameMargins -> 7, BaseStyle -> {}, 
         DefaultBaseStyle -> {"Panel", Background -> None}, BaselinePosition -> 
         Baseline]& )],
      DynamicModuleValues:>{}], "]"}],
    DataDistribution["SmoothKernel", {CompressedData["
1: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
Jiz/df//ALvBShY=
      "], CompressedData["
1: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
fBd5vA==
      "], 0.5316442933530237}, 1, 17999],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angularacc", "=", 
   InterpretationBox[
    RowBox[{
     TagBox["DataDistribution",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               GraphicsComplexBox[CompressedData["
1:eJw1029Q03UABvCx0QloC2GIZM2IZZpyWngwzXp+40x0ynHzijjhTAUOQ2Ge
NDTpDhaIyATGAbdQTnGEMFRErAHN+EJ0cyo7jiHCwQZj/vhbLWCDBey26gUv
nnvu8+J5+QSfEh9NZjIYjPD/8n8H17RMud0rJO87/pGDDgoHgqLGoxuWCWvm
FsegOoq4veU+IxFLRKjgvajnJ+EQJStYNjlIjiU0dParDHDTTEujhYuE90y+
89l2Kcz7/ypbs2mBdF6vqOmmiyD1qMvXdNnIsTMxYXN3FPD9mqt8GDNP7HUL
ebEJSnzvmG06Z5klbXi4Z9dwA+r6h3Zd3PQ3mXCveb71ZDN4fjGiMv6fJLvQ
WmUYaMWJjYEhT/KniXdNKfsSTZB0tmL4mmWC1KWYFTOmLkRuKBl/6UkTXsiX
JZN1OoxeNVbviRsj81nnZydVety9I4wX0EYydEzBWj/Si/f7D0aGhQ0QSs4Z
zA3txzsKqyyW7iVD5mz967mDqPLeMOf5mY6kStr9Tu83gg7ctzl7rYZchX/H
gnoUvvHhghavYrLt7cssQckYLH77gn576xHW+finPZiyoFLE0M3wf0euzt91
X/MKcZGSTxKf9oDVmXw9kkGDna/PfCzsx/wj17uOolc42ZMhrakYgvCs0xmQ
bkGOutTesc2MTJ4tl5tnhlwTcEExYAEMlm+9rhihTeXWT7ePY0wm1vYJBrC7
+9y86ocpuIYnuAXJBtCJYplI8AcEVeWZ29P0aKudN3wTYgX3NamNw9Nhil36
E1JnEXWNzW/fqIXvj9HrnJo5eKgaEp43ayEsPvJx5gc2yEW1XrfVT1Fbdnt9
Uo4dv7S9vGgb0cPfyidv2BZwP0ejMwt7oUzcwtkZ7YDxhk+41WlAdHOr5HL1
P2j8+UErs6UPa2OLGit9l7HFk5l1ZUcfZjitxcGnV+AoEkQFSHoxvPW9AylG
J44rlV3MvXpMB0T40IdcEPPYbxY0aRHIvSV5cdONSu/O5YqmDtz7lZcgKGBQ
J2TnIwY2q2Fa4okMuz2oD099+rnefRdVygvdLpMHtTj4xaJUVY1xyZmwwgom
FX/vifKGrBTtsT7pPRSL4sgngw7TUsh74+1uN4s6/pG6XrySjvDspsd9lJ1k
cRqjxi6Vo0qzIyIlg0mtevU/q17dr/pfEHq+aA==
                "], {{{
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    PolygonBox[{{50, 54, 52, 48, 49}}], 
                    PolygonBox[{{51, 53, 1, 2, 3, 4, 5, 6}}]}]}, {
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    
                    PolygonBox[{{51, 52, 47, 46, 45, 44, 43, 42, 41, 40, 39, 
                    38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 
                    24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 
                    10, 9, 8, 7}}]}]}, {}, {}}, {{}, {}, {
                   Directive[
                    Opacity[1.], 
                    GrayLevel[0.55], 
                    AbsoluteThickness[1.5]], 
                   
                   LineBox[{1, 2, 3, 4, 5, 6, 51, 7, 8, 9, 10, 11, 12, 13, 14,
                     15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 
                    43, 44, 45, 46, 47, 52, 48, 49, 50}]}}}], {
               DisplayFunction -> Identity, AspectRatio -> 1, 
                Axes -> {False, False}, AxesLabel -> {None, None}, 
                AxesOrigin -> {0, 0.02}, Background -> GrayLevel[0.93], 
                BaseStyle -> {FontFamily -> "Arial"}, DisplayFunction :> 
                Identity, Frame -> {{True, True}, {True, True}}, 
                FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
                Directive[
                  Thickness[Tiny], 
                  GrayLevel[0.7]], FrameTicks -> {{None, None}, {None, None}},
                 GridLines -> {None, None}, GridLinesStyle -> Directive[
                  GrayLevel[0.5, 0.4]], ImageSize -> {Automatic, 
                  Dynamic[
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])]}, LabelStyle -> {FontFamily -> "Arial"}, 
                Method -> {"ScalingFunctions" -> None, "AxesInFront" -> True},
                 PlotRange -> {All, All}, PlotRangeClipping -> True, 
                PlotRangePadding -> {{0, 0}, {0, 0.1}}, 
                Ticks -> {Automatic, Automatic}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"SmoothKernel\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Data points: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["17998", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               GraphicsComplexBox[CompressedData["
1:eJw1029Q03UABvCx0QloC2GIZM2IZZpyWngwzXp+40x0ynHzijjhTAUOQ2Ge
NDTpDhaIyATGAbdQTnGEMFRErAHN+EJ0cyo7jiHCwQZj/vhbLWCDBey26gUv
nnvu8+J5+QSfEh9NZjIYjPD/8n8H17RMud0rJO87/pGDDgoHgqLGoxuWCWvm
FsegOoq4veU+IxFLRKjgvajnJ+EQJStYNjlIjiU0dParDHDTTEujhYuE90y+
89l2Kcz7/ypbs2mBdF6vqOmmiyD1qMvXdNnIsTMxYXN3FPD9mqt8GDNP7HUL
ebEJSnzvmG06Z5klbXi4Z9dwA+r6h3Zd3PQ3mXCveb71ZDN4fjGiMv6fJLvQ
WmUYaMWJjYEhT/KniXdNKfsSTZB0tmL4mmWC1KWYFTOmLkRuKBl/6UkTXsiX
JZN1OoxeNVbviRsj81nnZydVety9I4wX0EYydEzBWj/Si/f7D0aGhQ0QSs4Z
zA3txzsKqyyW7iVD5mz967mDqPLeMOf5mY6kStr9Tu83gg7ctzl7rYZchX/H
gnoUvvHhghavYrLt7cssQckYLH77gn576xHW+finPZiyoFLE0M3wf0euzt91
X/MKcZGSTxKf9oDVmXw9kkGDna/PfCzsx/wj17uOolc42ZMhrakYgvCs0xmQ
bkGOutTesc2MTJ4tl5tnhlwTcEExYAEMlm+9rhihTeXWT7ePY0wm1vYJBrC7
+9y86ocpuIYnuAXJBtCJYplI8AcEVeWZ29P0aKudN3wTYgX3NamNw9Nhil36
E1JnEXWNzW/fqIXvj9HrnJo5eKgaEp43ayEsPvJx5gc2yEW1XrfVT1Fbdnt9
Uo4dv7S9vGgb0cPfyidv2BZwP0ejMwt7oUzcwtkZ7YDxhk+41WlAdHOr5HL1
P2j8+UErs6UPa2OLGit9l7HFk5l1ZUcfZjitxcGnV+AoEkQFSHoxvPW9AylG
J44rlV3MvXpMB0T40IdcEPPYbxY0aRHIvSV5cdONSu/O5YqmDtz7lZcgKGBQ
J2TnIwY2q2Fa4okMuz2oD099+rnefRdVygvdLpMHtTj4xaJUVY1xyZmwwgom
FX/vifKGrBTtsT7pPRSL4sgngw7TUsh74+1uN4s6/pG6XrySjvDspsd9lJ1k
cRqjxi6Vo0qzIyIlg0mtevU/q17dr/pfEHq+aA==
                "], {{{
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    PolygonBox[{{50, 54, 52, 48, 49}}], 
                    PolygonBox[{{51, 53, 1, 2, 3, 4, 5, 6}}]}]}, {
                   EdgeForm[], 
                   Directive[
                    GrayLevel[0.85]], 
                   GraphicsGroupBox[{
                    
                    PolygonBox[{{51, 52, 47, 46, 45, 44, 43, 42, 41, 40, 39, 
                    38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 
                    24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 
                    10, 9, 8, 7}}]}]}, {}, {}}, {{}, {}, {
                   Directive[
                    Opacity[1.], 
                    GrayLevel[0.55], 
                    AbsoluteThickness[1.5]], 
                   
                   LineBox[{1, 2, 3, 4, 5, 6, 51, 7, 8, 9, 10, 11, 12, 13, 14,
                     15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 
                    43, 44, 45, 46, 47, 52, 48, 49, 50}]}}}], {
               DisplayFunction -> Identity, AspectRatio -> 1, 
                Axes -> {False, False}, AxesLabel -> {None, None}, 
                AxesOrigin -> {0, 0.02}, Background -> GrayLevel[0.93], 
                BaseStyle -> {FontFamily -> "Arial"}, DisplayFunction :> 
                Identity, Frame -> {{True, True}, {True, True}}, 
                FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
                Directive[
                  Thickness[Tiny], 
                  GrayLevel[0.7]], FrameTicks -> {{None, None}, {None, None}},
                 GridLines -> {None, None}, GridLinesStyle -> Directive[
                  GrayLevel[0.5, 0.4]], ImageSize -> {Automatic, 
                  Dynamic[
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])]}, LabelStyle -> {FontFamily -> "Arial"}, 
                Method -> {"ScalingFunctions" -> None, "AxesInFront" -> True},
                 PlotRange -> {All, All}, PlotRangeClipping -> True, 
                PlotRangePadding -> {{0, 0}, {0, 0.1}}, 
                Ticks -> {Automatic, Automatic}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"SmoothKernel\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Data points: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["17998", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Input dimension: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "6.582885870325303`"}], ",", 
                    "6.461051988017351`"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Bandwidth: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.08195694285190089`", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel",
       DisplayFunction->(
        ButtonBox[#, Active -> False, Alignment -> Left, 
         Appearance -> {
          "Default" -> 
           FrontEnd`FileName[{"Typeset", "SummaryBox"}, "Panel.9.png"]}, 
         FrameMargins -> 7, BaseStyle -> {}, 
         DefaultBaseStyle -> {"Panel", Background -> None}, BaselinePosition -> 
         Baseline]& )],
      DynamicModuleValues:>{}], "]"}],
    DataDistribution["SmoothKernel", {CompressedData["
1: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
wCbl171xW5XA/l1yLeyzAOF/h/Cg5Q==
      "], CompressedData["
1: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
WIuXNw==
      "], 0.08195694285190089}, 1, 17998],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8437394802051816`*^9, 3.8437394992217703`*^9}, {
  3.843739611986385*^9, 3.8437396131866684`*^9}, {3.847556038503207*^9, 
  3.8475560426799517`*^9}, {3.847807964029857*^9, 3.8478079746842704`*^9}, {
  3.8480724486065264`*^9, 3.84807245797015*^9}, {3.8492088203680277`*^9, 
  3.8492088207377663`*^9}},ExpressionUUID->"f6f02074-4d50-4345-9e8a-\
29d237b0a494"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize", "Subsection",
 CellChangeTimes->{{3.842366082135882*^9, 
  3.842366083223463*^9}},ExpressionUUID->"1cf4057e-f27b-4823-a73b-\
c98aee6da8f9"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"avg", ",", "orr", ",", "w2", ",", "\[IndentingNewLine]", 
     RowBox[{"w1", "=", "0.7"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2", "=", 
     RowBox[{"1", "-", "w1"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"list", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"orientation", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"src", "=", 
        RowBox[{"file", "\[LeftDoubleBracket]", 
         RowBox[{"n", "+", 
          RowBox[{
           RowBox[{"Length", "[", "file", "]"}], "/", "2"}]}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"frames", "=", 
        RowBox[{
        "file", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"head", "=", 
        RowBox[{"src", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"thorax", "=", 
        RowBox[{"src", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"abdomen", "=", 
        RowBox[{"src", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Skip", " ", "invalid", " ", "positions", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "when"}], " ", "the", " ", 
            "body", " ", "segment", " ", 
            RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
           RowBox[{
           "use", " ", "previous", " ", "position", " ", "to", " ", "fill", 
            " ", "it", " ", "in"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"head", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"head", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"head", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"head", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"head", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"head", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", 
               RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "head", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"thorax", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"thorax", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"thorax", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"thorax", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"thorax", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"thorax", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", 
               RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "thorax", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"abdomen", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"abdomen", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"abdomen", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"abdomen", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "n"}], "\[RightDoubleBracket]"}], ">", "1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"abdomen", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"abdomen", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", 
               RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "abdomen", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Obtain", " ", 
          RowBox[{"the", " ", "'"}], 
          RowBox[{"center", "'"}], " ", "position", " ", "of", " ", "the", 
          " ", "ant", " ", "for", " ", "the", " ", "use", " ", "in", " ", 
          "positional", " ", "tracking"}], ",", " ", 
         RowBox[{
         "which", " ", "is", " ", "a", " ", "simple", " ", "average", " ", 
          "of", " ", "the", " ", "three", " ", "body", " ", 
          RowBox[{"segments", "'"}], " ", "position", " ", "vectors"}]}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"avg", "=", 
        FractionBox[
         RowBox[{"head", "+", "thorax", "+", "abdomen"}], "3."]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Obtain", " ", "orientation", " ", "of", " ", "the", " ", "ant"}], 
         ",", " ", 
         RowBox[{
         "which", " ", "is", " ", "a", " ", "weighed", " ", "sum", " ", "of", 
          " ", "a", " ", "pair", " ", "of", " ", "direction", " ", "vectors", 
          " ", "between", " ", "each", " ", "adjacent", " ", "pair", " ", 
          "of", " ", "body", " ", 
          RowBox[{"segments", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"orr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"w1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"head", "\[Transpose]"}], "\[LeftDoubleBracket]", "#",
                 "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{"thorax", "\[Transpose]"}], "\[LeftDoubleBracket]", 
                "#", "\[RightDoubleBracket]"}]}], ")"}]}], 
            RowBox[{"Norm", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"head", "\[Transpose]"}], "\[LeftDoubleBracket]", "#",
                 "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{"thorax", "\[Transpose]"}], "\[LeftDoubleBracket]", 
                "#", "\[RightDoubleBracket]"}]}], ")"}], "]"}]], "+", 
           FractionBox[
            RowBox[{"w2", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"thorax", "\[Transpose]"}], "\[LeftDoubleBracket]", 
                "#", "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{"abdomen", "\[Transpose]"}], "\[LeftDoubleBracket]", 
                "#", "\[RightDoubleBracket]"}]}], ")"}]}], 
            RowBox[{"Norm", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"thorax", "\[Transpose]"}], "\[LeftDoubleBracket]", 
                "#", "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{"abdomen", "\[Transpose]"}], "\[LeftDoubleBracket]", 
                "#", "\[RightDoubleBracket]"}]}], ")"}], "]"}]]}], "&"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{"(", 
            RowBox[{"thorax", "\[Transpose]"}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"orr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcCos2", "[", 
           RowBox[{
            RowBox[{"orr", "\[LeftDoubleBracket]", 
             RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"orr", "\[LeftDoubleBracket]", 
             RowBox[{"#", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "orr"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"list", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"frames", ",", 
            RowBox[{"avg", "\[Transpose]"}], ",", "orr"}], "}"}], 
          "\[Transpose]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"orientation", ",", 
         RowBox[{"{", 
          RowBox[{"frames", ",", "orr"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "file", "]"}], " ", "is", " ", "always", " ", 
         "an", " ", "even", " ", "number"}], ",", " ", 
        RowBox[{
        "because", " ", "the", " ", "converter", " ", "creates", " ", "one", 
         " ", "table", " ", "for", " ", "trajectory", " ", "and", " ", "one", 
         " ", "table", " ", "for", " ", "frame", " ", "numbers", " ", "for", 
         " ", "every", " ", "SLEAP", " ", "trajectory", " ", "in", " ", "the",
          " ", "input", " ", 
         RowBox[{"file", "."}]}]}], "*)"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{
         RowBox[{"Length", "[", "file", "]"}], "/", "2"}]}], "}"}]}], 
     "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8480556017099204`*^9, 3.848055819237471*^9}, {
  3.848055895476175*^9, 3.848055929705698*^9}, {3.848055963391176*^9, 
  3.848055966358511*^9}, {3.8480647555666256`*^9, 3.8480649432216268`*^9}, {
  3.848064980540921*^9, 3.848065055664627*^9}, {3.8480673787696333`*^9, 
  3.8480674610651026`*^9}, {3.8480675066374416`*^9, 3.8480675905975213`*^9}, {
  3.8480679794551067`*^9, 3.848068013526202*^9}, {3.848068050114638*^9, 
  3.848068072772019*^9}},ExpressionUUID->"20cf3692-e54b-4ded-9e67-\
b6011406eec6"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"list", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", ";;", ",", 
     RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",ExpressionUUID->\
"16a073b9-ff1b-4900-927f-ced31a09f030"],

Cell[BoxData[
 RowBox[{"list", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "1", ",", "2", ",", "1"}], 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.848068019817099*^9, 
  3.848068087183201*^9}},ExpressionUUID->"900e4c3b-7c72-4b17-b492-\
b36950c1aede"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Jump counts/disconnect trajectories", "Section",ExpressionUUID->"dd4200ec-6dce-4877-9599-98286e8fc3c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"jump", ",", 
      RowBox[{"\[Theta]", "=", "15.1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pruned", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"jump", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sc", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", "2", ",", 
                  RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "-", "1"}], ",", "2", ",", 
                  RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], ">", "\[Theta]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"pruned", ",", 
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"jump", ";;", 
                   RowBox[{"j", "-", "1"}]}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"jump", "=", "j"}], ";", "\[IndentingNewLine]", 
              RowBox[{"sc", "+=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"ct", "+=", "1"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "list", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sc", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"pruned", ",", 
             RowBox[{
             "list", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ct", "+=", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8480681007504954`*^9, 
  3.8480681318119683`*^9}},ExpressionUUID->"9ae078ee-425a-4d33-9bd4-\
18eef41ec0b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tr", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"pruned", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", ";;", ",", "2", ",", 
       RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Full"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.848068164771311*^9, 3.848068167063327*^9}, 
   3.84807184019331*^9},ExpressionUUID->"61017c8c-1cda-4bec-9018-\
6c178c5cf962"]
}, Closed]],

Cell[CellGroupData[{

Cell["Probability-based prediction compute", "Section",ExpressionUUID->"a1bb2d26-eaac-4961-b307-7d6f857dcf0c"],

Cell[CellGroupData[{

Cell["Hungarian", "Subsection",
 CellChangeTimes->{{3.843122267346241*^9, 3.843122272362314*^9}, {
  3.848068199419794*^9, 
  3.848068200369472*^9}},ExpressionUUID->"f9f9637c-01df-4357-9c01-\
9d4ed8b7c85f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AdjustMatrix", "[", 
    RowBox[{
    "matrix_", ",", "markedrows_", ",", "markedcolumns_", ",", "size_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nonmarked", ",", "values", ",", "minval", ",", "modmatrix"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Create", " ", "storage", " ", "for", " ", "all", " ", "elements", " ", 
       "not", " ", "in", " ", "either", " ", "marked", " ", "rows", " ", "or",
        " ", "marked", " ", 
       RowBox[{"columns", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nonmarked", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Iterate", " ", "through", " ", "each", " ", "row", " ", "and", " ", 
         RowBox[{"column", ".", " ", "If"}], " ", "row", " ", "and", " ", 
         "column", " ", "are", " ", "not", " ", "found", " ", "in", " ", 
         RowBox[{"markedrow", "/", "markedcolumn"}], " ", "lists"}], ",", " ", 
        RowBox[{"then", " ", "add", " ", "the", " ", 
         RowBox[{"row", "/", "column"}], " ", "pair", " ", "to", " ", "list", 
         " ", "of", " ", "unmarked", " ", 
         RowBox[{"values", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"markedrows", ",", "i"}], "]"}]}], "\[And]", 
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"markedcolumns", ",", "j"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nonmarked", "=", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"nonmarked", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Convert", " ", "the", " ", "coordinate", " ", "of", " ", "unmarked", 
        " ", "values", " ", "to", " ", "unmarked", " ", "values", " ", 
        RowBox[{"themselves", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"matrix", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"nonmarked", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"nonmarked", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "nonmarked"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Find", " ", "the", " ", "minimum", " ", "among", " ", "unmarked", " ", 
        RowBox[{"values", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"minval", "=", 
       RowBox[{"Min", "[", "values", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Create", " ", "a", " ", "new", " ", "copy", " ", "of", " ", "cost", 
        " ", "matrix", " ", "for", " ", 
        RowBox[{"modification", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"modmatrix", "=", "matrix"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Check", " ", "each", " ", "matrix", " ", "position"}], ";", 
         " ", 
         RowBox[{
         "if", " ", "position", " ", "is", " ", "not", " ", "a", " ", 
          "marked", " ", "position"}]}], ",", " ", 
        RowBox[{
         RowBox[{"subtract", " ", "minimum", " ", "non"}], "-", 
         RowBox[{"marked", " ", 
          RowBox[{"value", ".", " ", "If"}], " ", "position", " ", "falls", 
          " ", "in", " ", "both", " ", "a", " ", "marked", " ", "row", " ", 
          "and", " ", "a", " ", "marked", " ", "column"}]}], ",", " ", 
        RowBox[{
         RowBox[{"add", " ", "minimumn", " ", "non"}], "-", 
         RowBox[{"marked", " ", 
          RowBox[{"value", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"nonmarked", "\[LeftDoubleBracket]", 
               RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              "i"}], "]"}], "\[And]", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"nonmarked", "\[LeftDoubleBracket]", 
               RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
              "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"modmatrix", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "-=", 
            "minval"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"markedrows", ",", "i"}], "]"}], "\[And]", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"markedcolumns", ",", "j"}], "]"}]}], ",", 
             "\[IndentingNewLine]", " ", 
             RowBox[{
              RowBox[{"modmatrix", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "+=", 
              "minval"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Return", " ", "the", " ", "modified", " ", "matrix", " ", "for", " ", 
        "next", " ", "iteration", " ", "of", " ", "main", " ", 
        RowBox[{"loop", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "modmatrix", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.842564933885182*^9, 3.842565312982204*^9}, {
   3.8425653523335004`*^9, 3.842565362860721*^9}, {3.842565416668044*^9, 
   3.8425654452201185`*^9}, {3.842565799809883*^9, 3.8425658283698845`*^9}, {
   3.8425658985924373`*^9, 3.8425659413035326`*^9}, {3.8426892858877764`*^9, 
   3.8426894122764435`*^9}, {3.8426896011494102`*^9, 3.8426897664699173`*^9}, 
   3.842709235482005*^9, {3.843134077586994*^9, 3.8431340842421775`*^9}, {
   3.8431341548255377`*^9, 3.8431341867522025`*^9}, {3.843134232184476*^9, 
   3.843134284279708*^9}, {3.843134342208777*^9, 3.843134461670355*^9}, 
   3.8431363878343506`*^9, {3.8431365145213904`*^9, 3.8431365222755675`*^9}, 
   3.843142577866581*^9, {3.8431437389112263`*^9, 3.843143743869074*^9}, {
   3.843174624397267*^9, 
   3.8431748286675434`*^9}},ExpressionUUID->"52bc2e94-520e-4382-96be-\
84fd161aa85c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hungarian", "[", 
   RowBox[{"sources_", ",", "targets_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "src", ",", "tgt", ",", "presrc", ",", "prob", ",", "size", ",", 
      "costmatrix", ",", "costog", ",", "invprob", ",", "boolmat", ",", 
      "zerocount", ",", "zero", ",", "minrow", ",", "markedzeros", ",", 
      "markedrows", ",", "markedcolumns", ",", "unmarkedrows", ",", 
      "unmarkedzeros", ",", "markedtotal", ",", "\[IndentingNewLine]", 
      RowBox[{"solved", "=", "False"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{"Iteration", " ", "criterion"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"searchrange", "=", "5"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "How", " ", "far", " ", "into", " ", "future", " ", "should", " ", 
       "the", " ", "trajectory", " ", "linker", " ", "look", " ", "to", " ", 
       "for", " ", 
       RowBox[{"search", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Initialization", ".", "\[IndentingNewLine]", "1."}], " ", 
       "Define", " ", "the", " ", "size", " ", "as", " ", "the", " ", 
       "longer", " ", "of", " ", "the", " ", "two", " ", "dimensions", " ", 
       "between", " ", "sources", " ", "and", " ", 
       RowBox[{"targets", ".", "\[IndentingNewLine]", "2."}], " ", "Create", 
       " ", "a", " ", "square", " ", "matrix", " ", "with", " ", "the", " ", 
       "size", " ", "as", " ", "chosen", " ", 
       RowBox[{"above", ".", "\[IndentingNewLine]", "3."}], " ", "Subtract", 
       " ", "match", " ", "probability", " ", "from", " ", "this", " ", 
       "square", " ", 
       RowBox[{"matrix", ".", "\[IndentingNewLine]", "4."}], " ", 
       RowBox[{"The", " ", "'"}], 
       RowBox[{"padding", "'"}], " ", "elements", " ", "can", " ", "be", " ", 
       "left", " ", "at", " ", "initial", " ", 
       RowBox[{"value", ".", "\[IndentingNewLine]", "This"}], " ", "part", 
       " ", "corresponds", " ", "to", " ", "lines", " ", "1"}], "-", 
      RowBox[{"8", " ", "in", " ", "the", " ", "line"}], "-", "by", "-", 
      RowBox[{"line", " ", "pseudocode", " ", "in", " ", 
       RowBox[{"notes", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sources", "]"}], ",", 
         RowBox[{"Length", "[", "targets", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "It", " ", "is", " ", "necessary", " ", "to", " ", "define", " ", 
       "costmatrix", " ", "as", " ", "square", " ", "matrix", " ", "first", 
       " ", "because", " ", "we", " ", "need", " ", "a", " ", "bijective", 
       " ", "mapping", " ", "for", " ", "linear", " ", "sum", " ", 
       "assignment", " ", "algorithms", " ", "to", " ", "work"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"costmatrix", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"size", ",", "size"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Get", " ", "source"}], ",", " ", 
        RowBox[{"pre", "-", 
         RowBox[{
         "source", " ", "and", " ", "target", " ", "coordinates"}]}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"src", "=", 
         RowBox[{"pruned", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
           "sources", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"presrc", "=", 
         RowBox[{"pruned", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
           "sources", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tgt", "=", 
         RowBox[{"pruned", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
           "targets", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "If", " ", "target", " ", "is", " ", "outside", " ", "search", " ", 
           "range", " ", "or", " ", "if", " ", "target", " ", "has", " ", 
           "timestamp", " ", "earlier", " ", "than", " ", "source"}], ",", 
          " ", 
          RowBox[{"then", " ", "assign", " ", "0", " ", "for", " ", 
           RowBox[{"probability", "."}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"prob", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "tgt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "src", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "+", "searchrange"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "tgt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "src", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
              ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"prob", "=", 
             RowBox[{"GetProb", "[", 
              RowBox[{"presrc", ",", "src", ",", "tgt"}], "]"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"1", "-", "prob"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sources", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "targets", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Save", " ", "unadjusted", " ", "copy", " ", "for", " ", "later", " ", 
       "output"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"costog", "=", "costmatrix"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Subtract", " ", "minima", " ", "from", " ", "each", " ", "row"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "costmatrix", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{
         RowBox[{
         "costmatrix", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          "-", 
         RowBox[{"Min", "[", 
          RowBox[{
          "costmatrix", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Subtract", " ", "minima", " ", "from", " ", "each", " ", "column"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{
         RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"Min", "[", 
          RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Initiate", " ", "loop", " ", "for", " ", "linear", " ", 
        RowBox[{"assignment", ".", "\[IndentingNewLine]", "1."}], " ", 
        "Select", " ", "particular", " ", "zero", " ", "elements", " ", "and",
         " ", "save", " ", "them", " ", "as", " ", "marked", " ", 
        RowBox[{"zeros", ".", "\[IndentingNewLine]", "2."}], " ", "Check", 
        " ", "whether", " ", "the", " ", "marked", " ", "zeros", " ", 
        "complete", " ", "the", " ", "assignment", " ", 
        RowBox[{"problem", ".", "\[IndentingNewLine]", "3."}], " ", "If", " ",
         "it", " ", "works"}], ",", " ", 
       RowBox[{
       "then", " ", "return", " ", "the", " ", "marked", " ", "zeros", " ", 
        "and", " ", 
        RowBox[{"terminate", ".", "\[IndentingNewLine]", "4."}], " ", "If", 
        " ", "not"}], ",", " ", 
       RowBox[{
       "modify", " ", "the", " ", "cost", " ", "matrix", " ", "and", " ", 
        "try", " ", 
        RowBox[{"again", ".", "\[IndentingNewLine]", "The"}], " ", "entire", 
        " ", "loop", " ", "corresponds", " ", "to", " ", "the", " ", 
        "repeating", " ", "lines", " ", "9", " ", "through", " ", "to", " ", 
        "56", " ", "in", " ", "the", " ", 
        RowBox[{"notes", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "loop", " ", "count", " ", "is", " ", "included", " ", 
       "to", " ", "prevent", " ", "infinite", " ", "loops", " ", "during", 
       " ", "debugging"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"loop", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", "solved"}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{"loop", "<", 
          RowBox[{"(", 
           RowBox[{"10", "size"}], ")"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"loop", "+=", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Make", " ", "an", " ", "N", " ", "by", " ", "N", " ", "boolean", 
          " ", "matrix", " ", "where", " ", "the", " ", "zeros", " ", "are", 
          " ", "marked", " ", "with", " ", "True", " ", "and", " ", "others", 
          " ", "by", " ", "False"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"boolmat", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"False", ",", 
           RowBox[{"{", 
            RowBox[{"size", ",", "size"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"boolmat", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
             "True"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Create", " ", "a", " ", "store", " ", "for", " ", "marked", " ", 
          RowBox[{"zeros", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"markedzeros", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Initiate", " ", "loop", " ", "to", " ", "mark", " ", 
           RowBox[{"zeros", ".", "\[IndentingNewLine]", "1."}], " ", "Select",
            " ", "row", " ", "with", " ", "fewest", " ", 
           RowBox[{"zeros", ".", "\[IndentingNewLine]", "2."}], " ", "Pick", 
           " ", "the", " ", "first", " ", "zero", " ", "in", " ", "such", " ",
            "row", " ", "and", " ", "save", " ", "its", " ", "row"}], ",", 
          " ", 
          RowBox[{"column", " ", 
           RowBox[{"number", ".", " ", "Include"}], " ", "this", " ", "zero", 
           " ", "in", " ", 
           RowBox[{"marked_zeros", ".", "\[IndentingNewLine]", "3."}], " ", 
           "Repeat", " ", "until", " ", "boolean", " ", "matrix", " ", "has", 
           " ", "no", " ", "True", " ", 
           RowBox[{"elements", ".", "\[IndentingNewLine]", "This"}], " ", 
           "loop", " ", "corresponds", " ", "to", " ", "repeating", " ", 
           "lines", " ", "10", " ", "through", " ", "to", " ", "18", " ", 
           "in", " ", "the", " ", 
           RowBox[{"notes", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "THIS", " ", "BLOCK", " ", "BELOW", " ", "SEEMS", " ", "TO", " ", 
           "CONTAIN", " ", "ERROR"}], ";", " ", 
          RowBox[{
           RowBox[{"Length", "@", "markedzeros"}], " ", "\[NotEqual]", " ", 
           RowBox[{"size", " ", "of", " ", "matrix"}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Check", " ", "whether", " ", "boolmat", " ", "contains", " ", "any",
           " ", "True", " ", "valued", " ", 
          RowBox[{"elements", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "boolmat"}], ",", "True"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ct", "+=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Count", " ", "the", " ", "number", " ", "of", " ", "True", " ", 
             "in", " ", "boolmat", " ", 
             RowBox[{"(", 
              RowBox[{
              "equal", " ", "to", " ", "number", " ", "of", " ", "zeros", " ",
                "in", " ", "the", " ", "cost", " ", "matrix"}], ")"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"zerocount", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{
                "boolmat", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", "True"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Select", " ", "the", " ", "row", " ", "with", " ", "fewest", " ",
              "nonzero", " ", "number", " ", "of", " ", 
             RowBox[{"True", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nonzeros", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Range", "[", "size", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "zerocount", "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", "0"}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"minrow", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"nonzeros", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "zerocount", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}], "\[Equal]", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                   "zerocount", "\[LeftDoubleBracket]", "nonzeros", 
                    "\[RightDoubleBracket]"}], "]"}]}], ")"}], "&"}]}], "]"}],
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Select", " ", "the", " ", "first", " ", "zero", " ", "element", 
             " ", "on", " ", "the", " ", "chosen", " ", 
             RowBox[{"row", ".", " ", 
              RowBox[{"The", " ", "'"}]}], 
             RowBox[{"zero", "'"}], " ", "variable", " ", "is", " ", "its", 
             " ", "column", " ", 
             RowBox[{"index", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"zero", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Range", "[", "size", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"boolmat", "\[LeftDoubleBracket]", 
                  RowBox[{"minrow", ",", "#"}], "\[RightDoubleBracket]"}], 
                 "\[Equal]", "True"}], "&"}], ",", "1"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Save", " ", "the", " ", "row", " ", "and", " ", "column", " ", 
             "index", " ", "of", " ", "the", " ", "zero", " ", "to", " ", 
             "markedzero", " ", 
             RowBox[{"list", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"markedzeros", "=", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"markedzeros", ",", 
              RowBox[{"{", 
               RowBox[{"minrow", ",", "zero"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"On", " ", "the", " ", "boolean", " ", "matrix"}], ",", 
             " ", 
             RowBox[{
             "set", " ", "all", " ", "elements", " ", "on", " ", "the", " ", 
              "selected", " ", "row", " ", "and", " ", "column", " ", "as", 
              " ", 
              RowBox[{"False", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"boolmat", "\[LeftDoubleBracket]", 
             RowBox[{"minrow", ",", ";;"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"False", ",", 
              RowBox[{"{", "size", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"boolmat", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "zero"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"False", ",", 
              RowBox[{"{", "size", "}"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"boolmat", "//", "MatrixForm"}], ",", "ct", ",", 
              "markedzeros"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Reset", " ", "the", " ", "boolmat", " ", "since", " ", "we", " ", 
          "turned", " ", "all", " ", "of", " ", "its", " ", "entries", " ", 
          "to", " ", "False", " ", "in", " ", "the", " ", "above", " ", 
          RowBox[{"loop", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"boolmat", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"False", ",", 
           RowBox[{"{", 
            RowBox[{"size", ",", "size"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"boolmat", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
             "True"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Mark", " ", "rows", " ", "and", " ", "columns", " ", "to", " ", 
           "attempt", " ", "to", " ", "complete", " ", "the", " ", 
           RowBox[{"assignment", ".", "\[IndentingNewLine]", "1."}], " ", 
           "Save", " ", 
           RowBox[{"rows", "/", "columns"}], " ", "of", " ", "the", " ", 
           "marked", " ", "zeros", " ", "on", " ", "respective", " ", 
           RowBox[{"lists", ".", "\[IndentingNewLine]", "2."}], " ", "Save", 
           " ", "any", " ", "rows", " ", "not", " ", "included", " ", "in", 
           " ", "such", " ", "list", " ", "onto", " ", "a", " ", "different", 
           " ", "list", " ", "for", " ", 
           RowBox[{"unmarkedrows", ".", "\[IndentingNewLine]", "3."}], " ", 
           "Zero", " ", "elements", " ", "on", " ", "unmarked", " ", "rows", 
           " ", "are", " ", "identified", " ", "and", " ", "their", " ", 
           "column", " ", "values", " ", "are", " ", 
           RowBox[{"marked", ".", "\[IndentingNewLine]", "4."}], " ", "If", 
           " ", "the", " ", "row", " ", "and", " ", "column", " ", "are", " ",
            "both", " ", "marked", " ", "for", " ", "some", " ", "element"}], 
          ",", " ", 
          RowBox[{"label", " ", "the", " ", "row", " ", "as", " ", 
           RowBox[{"unmarked", ".", "\[IndentingNewLine]", "5."}], " ", 
           "Iterate", " ", 
           RowBox[{"2", "~", "4"}], " ", "until", " ", "all", " ", "rows", 
           " ", "and", " ", "columns", " ", "are", " ", "populated", " ", 
           "into", " ", "appropriate", " ", 
           RowBox[{"list", ".", "\[IndentingNewLine]", "6."}], " ", "Any", 
           " ", "row", " ", "that", " ", 
           RowBox[{"isn", "'"}], "t", " ", "in", " ", "unmarked", " ", "rows",
            " ", "are", " ", "added", " ", "to", " ", "marked", " ", 
           RowBox[{"rows", ".", "\[IndentingNewLine]", "This"}], " ", 
           "module", " ", "corresponds", " ", "to", " ", "steps", " ", "19", 
           " ", "through", " ", "to", " ", "41", " ", "on", " ", "the", " ", 
           RowBox[{"notes", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "zerorows", ",", "zerocols", ",", "switch", ",", "selectedrow", 
            ",", "row", ",", "col"}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Reset", " ", "the", " ", "markedcolumns", " ", "and", " ", 
            "markedrow", " ", "list", " ", "everytime", " ", "matrix", " ", 
            "is", " ", "adjusted"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"markedrows", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Identify", " ", "row", " ", "numbers", " ", "of", " ", "marked", 
             " ", "zeros"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"zerorows", "=", 
            RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Identify", " ", "column", " ", "numbers", " ", "of", " ", 
             "marked", " ", "zeros"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"zerocols", "=", 
            RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
             RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Select", " ", "all", " ", "rows", " ", "that", " ", "are", " ", 
             "not", " ", "in", " ", 
             RowBox[{"zerorows", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"unmarkedrows", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Range", "[", "size", "]"}], ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"zerorows", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Create", " ", "a", " ", "new", " ", "list", " ", "to", " ", 
             "store", " ", "marked", " ", 
             RowBox[{"columns", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"markedcolumns", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"switch", "=", "True"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Main", " ", "loop", " ", "for", " ", "marking", " ", 
             RowBox[{"rows", "/", 
              RowBox[{"columns", "."}]}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"switch", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Disable", " ", "the", " ", "repeat", " ", "switch", " ", 
               "immediately", " ", "so", " ", "that", " ", "loop", " ", 
               RowBox[{"doesn", "'"}], "t", " ", "continue", " ", "unless", 
               " ", "new", " ", "assignment", " ", "is", " ", 
               RowBox[{"possible", "."}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"switch", "=", "False"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"First", " ", "nested", " ", "stack"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Iterate", " ", "through", " ", "unmarked", " ", "rows"}], 
                " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"row", "=", 
                  RowBox[{
                  "unmarkedrows", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"selectedrow", "=", 
                  RowBox[{
                  "boolmat", "\[LeftDoubleBracket]", "row", 
                   "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Iterate", " ", "through", " ", "each", " ", "columns"}], 
                   " ", "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Check", " ", "whether", " ", "the", " ", "jth", " ", 
                    "element", " ", "is", " ", "True", " ", "and", " ", "j", 
                    " ", "is", " ", "not", " ", "already", " ", "in", " ", 
                    "markedcolumns"}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "selectedrow", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "True"}], "\[And]", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"markedcolumns", ",", "j"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Add", " ", "j", " ", "to", " ", "markedcolumns", " ", 
                    "and", " ", "enable", " ", "switch", " ", "to", " ", 
                    "check", " ", "for", " ", "other", " ", "possible", " ", 
                    RowBox[{"assignment", "."}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"markedcolumns", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"markedcolumns", ",", "j"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"switch", "=", "True"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "unmarkedrows", "]"}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"Second", " ", "nested", " ", "stack"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Iterate", " ", "through", " ", "each", " ", "marked", " ", 
                 "zeros"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"row", "=", 
                  RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"col", "=", 
                  RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Check", " ", "if", " ", "the", " ", "marked", " ", "zero",
                     " ", 
                    RowBox[{"element", "'"}], "s", " ", "row", " ", "and", 
                    " ", "column", " ", "are", " ", "both", " ", 
                    RowBox[{"marked", "."}]}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"unmarkedrows", ",", "row"}], "]"}]}], "\[And]", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"markedcolumns", ",", "col"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "If", " ", "so", " ", "then", " ", "place", " ", "the", 
                    " ", "corresponding", " ", "row", " ", "into", " ", "the",
                     " ", "list", " ", "of", " ", "unmarked", " ", 
                    RowBox[{"rows", "."}]}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"unmarkedrows", "=", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"unmarkedrows", ",", "row"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"switch", "=", "True"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", 
                  RowBox[{"Length", "@", "markedzeros"}]}], "}"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Once", " ", "the", " ", "loop", " ", "is", " ", "done"}], ",", 
             " ", 
             RowBox[{
             "unmarkedrows", " ", "and", " ", "markedcolumns", " ", "are", 
              " ", "fully", " ", 
              RowBox[{"populated", ".", " ", "Lastly"}]}], ",", " ", 
             RowBox[{
             "populate", " ", "markedrows", " ", "by", " ", "selecting", " ", 
              "the", " ", "complement", " ", "set", " ", "of", " ", 
              RowBox[{"unmarkedrows", "."}]}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"markedrows", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Range", "[", "size", "]"}], ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"unmarkedrows", ",", "#"}], "]"}]}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Check", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
             "marked", " ", "rows", " ", "and", " ", "columns"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"markedtotal", "=", 
            RowBox[{
             RowBox[{"Length", "[", "markedrows", "]"}], "+", 
             RowBox[{"Length", "[", "markedcolumns", "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"markedtotal", "\[Equal]", "size"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "If", " ", "it", " ", "matches", " ", "the", " ", "size", " ", 
             "of", " ", "the", " ", "matrix"}], ",", " ", 
            RowBox[{
            "disable", " ", "while", " ", "loop", " ", "and", " ", "return", 
             " ", "the", " ", 
             RowBox[{"result", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"solved", "=", "True"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                "markedzeros", "\[LeftDoubleBracket]", "n", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"1", "-", 
                 RowBox[{"costog", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "markedzeros"}]}]}], "}"}]}], "]"}], 
            "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "If", " ", "it", " ", "does", " ", "not", " ", "match", " ", 
             "the", " ", "size", " ", "of", " ", "matrix"}], ",", " ", 
            RowBox[{
            "modify", " ", "the", " ", "matrix", " ", "and", " ", "try", " ", 
             RowBox[{"again", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"costmatrix", "=", 
            RowBox[{"AdjustMatrix", "[", 
             RowBox[{
             "costmatrix", ",", "markedrows", ",", "markedcolumns", ",", 
              "size"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8423799767491903`*^9, 3.8423799879208946`*^9}, {
   3.842380052081381*^9, 3.842380069120224*^9}, {3.8423801641980886`*^9, 
   3.8423802447425227`*^9}, {3.8423802779243965`*^9, 
   3.8423802828928094`*^9}, {3.8424396388495693`*^9, 
   3.8424398644536033`*^9}, {3.8424402089169292`*^9, 
   3.8424402834491873`*^9}, {3.8424403511445513`*^9, 3.842440369616119*^9}, {
   3.842440410078659*^9, 3.8424406512767487`*^9}, {3.8424473523061676`*^9, 
   3.842447352385768*^9}, {3.842447408248661*^9, 3.8424474297286177`*^9}, {
   3.8424476159989557`*^9, 3.8424476193335943`*^9}, {3.842448140543302*^9, 
   3.842448483507962*^9}, {3.8424486863206186`*^9, 3.842448735640299*^9}, {
   3.8424487671404037`*^9, 3.842448769856806*^9}, {3.842454589432428*^9, 
   3.84245462698254*^9}, {3.84245523267966*^9, 3.842455405222046*^9}, {
   3.842455892008404*^9, 3.8424559969022646`*^9}, {3.8424561109323845`*^9, 
   3.842456193780012*^9}, {3.84245623710714*^9, 3.8424562766195116`*^9}, {
   3.8424563262427707`*^9, 3.842456341521786*^9}, {3.8424564152816935`*^9, 
   3.8424564184018106`*^9}, {3.8424564829762945`*^9, 3.842456490177888*^9}, {
   3.8424626708672805`*^9, 3.8424626774687243`*^9}, {3.8424627351378965`*^9, 
   3.842462778371677*^9}, {3.842462994860051*^9, 3.8424629967402954`*^9}, {
   3.8424635277302074`*^9, 3.8424635979904575`*^9}, {3.842463673985657*^9, 
   3.8424636743942723`*^9}, {3.8424638135121565`*^9, 3.842463826914259*^9}, {
   3.842463863992174*^9, 3.842463929906114*^9}, {3.842464067471225*^9, 
   3.84246407906524*^9}, {3.8424641709277573`*^9, 3.842464173064046*^9}, {
   3.842464983462772*^9, 3.8424650049298124`*^9}, {3.84246528452767*^9, 
   3.842465366064603*^9}, {3.842531106312228*^9, 3.842531111904215*^9}, {
   3.842531170806563*^9, 3.8425312175441875`*^9}, {3.8425353192187033`*^9, 
   3.8425353873925514`*^9}, {3.842535873329647*^9, 3.8425358816892242`*^9}, {
   3.842537908955903*^9, 3.842537943370816*^9}, {3.842537983204636*^9, 
   3.842538030986149*^9}, {3.8425381000166016`*^9, 3.8425381196338596`*^9}, {
   3.8425387635999627`*^9, 3.8425388418266783`*^9}, {3.842539331175338*^9, 
   3.842539331542472*^9}, {3.842539374112077*^9, 3.8425394383095756`*^9}, {
   3.8425394696561885`*^9, 3.842539482662818*^9}, {3.842539998028343*^9, 
   3.8425402913687487`*^9}, {3.842540697323415*^9, 3.8425406976828594`*^9}, 
   3.8425601491194553`*^9, 3.842562770613078*^9, {3.8425646451260686`*^9, 
   3.842564673045337*^9}, {3.84256485911615*^9, 3.8425648668756633`*^9}, {
   3.8425649210426974`*^9, 3.8425649308676214`*^9}, {3.842565989944866*^9, 
   3.8425660155361404`*^9}, {3.842695886791564*^9, 3.8426959136561546`*^9}, {
   3.8426961254762163`*^9, 3.842696131182605*^9}, {3.8426961909791813`*^9, 
   3.842696236947603*^9}, {3.842696283979556*^9, 3.842696300388404*^9}, {
   3.8426963785896215`*^9, 3.842696383677041*^9}, {3.8426964452322226`*^9, 
   3.8426964990194435`*^9}, {3.8426966283725557`*^9, 
   3.8426966292315702`*^9}, {3.8426966756273303`*^9, 
   3.8426967052551794`*^9}, {3.842696993979254*^9, 3.8426970033330307`*^9}, {
   3.8426971282289476`*^9, 3.8426971314525805`*^9}, {3.8426971674030952`*^9, 
   3.842697203561361*^9}, {3.842697264410886*^9, 3.8426972737376623`*^9}, {
   3.842697443728713*^9, 3.8426974447699614`*^9}, {3.8426974811966743`*^9, 
   3.8426974965010757`*^9}, 3.842697624078966*^9, {3.8426976650619555`*^9, 
   3.8426977078732157`*^9}, {3.842697738245496*^9, 3.8426977456902514`*^9}, {
   3.8426977951246166`*^9, 3.842697796400037*^9}, {3.8426978283807898`*^9, 
   3.842697854681916*^9}, {3.8426978991167045`*^9, 3.842697899960123*^9}, {
   3.8426979421269264`*^9, 3.84269798782723*^9}, {3.8427084457616663`*^9, 
   3.8427084468744125`*^9}, {3.84270935068367*^9, 3.8427093868961368`*^9}, {
   3.8427094707818637`*^9, 3.842709472416069*^9}, {3.84270969227848*^9, 
   3.8427097252942357`*^9}, {3.842709758961383*^9, 3.842709762921996*^9}, {
   3.8427103078059597`*^9, 3.842710341376128*^9}, {3.842710423729542*^9, 
   3.842710435419557*^9}, 3.8427104672517815`*^9, {3.842710540160819*^9, 
   3.8427105490569615`*^9}, {3.842710654364008*^9, 3.8427106753452106`*^9}, {
   3.842710706471156*^9, 3.8427107125838366`*^9}, {3.8427107748783045`*^9, 
   3.842710809819256*^9}, {3.84271096999607*^9, 3.8427110252543993`*^9}, {
   3.8427111108652487`*^9, 3.8427111772674465`*^9}, {3.84271124260981*^9, 
   3.842711319643758*^9}, {3.8427137435578213`*^9, 3.842713755339307*^9}, 
   3.8431217197505903`*^9, {3.843122095034792*^9, 3.843122106395162*^9}, {
   3.843122139611931*^9, 3.843122185763547*^9}, {3.8431222226888647`*^9, 
   3.843122260374134*^9}, {3.8431222927457848`*^9, 3.8431222942393036`*^9}, {
   3.843122332823935*^9, 3.8431223397671347`*^9}, {3.8431223719597826`*^9, 
   3.843122378599636*^9}, {3.843122411746229*^9, 3.843122413231572*^9}, {
   3.8431225234417777`*^9, 3.8431225249455595`*^9}, {3.8431225582544127`*^9, 
   3.843122573129491*^9}, {3.8431227497954855`*^9, 3.843122755380459*^9}, {
   3.843123253472132*^9, 3.8431233358489275`*^9}, {3.843123391040426*^9, 
   3.8431236630004168`*^9}, {3.8431239331385155`*^9, 3.843123974364668*^9}, {
   3.8431240771458993`*^9, 3.8431240794889655`*^9}, 3.843124172480937*^9, {
   3.8431294533648744`*^9, 3.8431295016344395`*^9}, {3.843129662124965*^9, 
   3.843129667576972*^9}, {3.843129708103492*^9, 3.8431297323355927`*^9}, {
   3.8431298510960817`*^9, 3.8431299008886976`*^9}, {3.8431300017517033`*^9, 
   3.8431300040772376`*^9}, {3.843130073151067*^9, 3.843130075914316*^9}, {
   3.8431301594540377`*^9, 3.843130211902939*^9}, {3.8431302600039196`*^9, 
   3.843130272684346*^9}, {3.8431303060752926`*^9, 3.8431303177316923`*^9}, {
   3.84313041936623*^9, 3.8431304578507338`*^9}, {3.8431304999971223`*^9, 
   3.84313058948765*^9}, {3.8431306563846407`*^9, 3.8431306988705587`*^9}, {
   3.8431307387435417`*^9, 3.8431308671325865`*^9}, {3.843130917350419*^9, 
   3.8431310050193744`*^9}, 3.843131095637493*^9, {3.843131168483179*^9, 
   3.8431312030740094`*^9}, {3.843131235050089*^9, 3.8431312360092554`*^9}, {
   3.843131266612666*^9, 3.8431312874809847`*^9}, {3.84313132053222*^9, 
   3.8431314212500076`*^9}, 3.8431316200410967`*^9, {3.8431328012356267`*^9, 
   3.843132882664527*^9}, {3.843132961039133*^9, 3.843132975009133*^9}, {
   3.8431330056522517`*^9, 3.843133018751148*^9}, {3.8431331434574237`*^9, 
   3.8431331761816993`*^9}, {3.843133211908748*^9, 3.843133233557297*^9}, {
   3.8431332655530567`*^9, 3.843133359651779*^9}, 3.8431333900839243`*^9, {
   3.843133427116311*^9, 3.843133503365755*^9}, {3.843133547159811*^9, 
   3.843133554546012*^9}, {3.8431336238527575`*^9, 3.8431336314417233`*^9}, {
   3.843133703233509*^9, 3.8431337831517024`*^9}, {3.8431338389348073`*^9, 
   3.8431339729334354`*^9}, {3.843134096444042*^9, 3.8431341296433077`*^9}, 
   3.8431344226097517`*^9, {3.8431363730113487`*^9, 3.8431363776031284`*^9}, {
   3.843136418482682*^9, 3.8431365076508245`*^9}, {3.843136557826397*^9, 
   3.843136601378632*^9}, {3.8431368248671923`*^9, 3.843136939679491*^9}, {
   3.8431415702466164`*^9, 3.843141620712332*^9}, {3.8431419956807785`*^9, 
   3.843142010273655*^9}, {3.8431421390732727`*^9, 3.8431423886854706`*^9}, {
   3.8431425554451*^9, 3.8431425593902273`*^9}, 3.8431426105569687`*^9, {
   3.8431426432773795`*^9, 3.8431427364124346`*^9}, {3.8431427714992733`*^9, 
   3.843142771690278*^9}, {3.843142862362302*^9, 3.8431429410177317`*^9}, {
   3.8431430460219684`*^9, 3.843143082480864*^9}, {3.843143114336087*^9, 
   3.843143117725212*^9}, {3.84314319049501*^9, 3.8431431921737986`*^9}, {
   3.8431432615825834`*^9, 3.8431432801791706`*^9}, {3.8431433246699605`*^9, 
   3.8431433495970874`*^9}, {3.8431434645240173`*^9, 3.843143471473205*^9}, {
   3.843143592547414*^9, 3.843143698864461*^9}, {3.8431437610106773`*^9, 
   3.843143789818332*^9}, 3.8431438584626055`*^9, {3.8431438969886417`*^9, 
   3.84314389852614*^9}, {3.8431439331827316`*^9, 3.8431439365401707`*^9}, {
   3.8431439666951904`*^9, 3.8431439994838743`*^9}, {3.8431440510531855`*^9, 
   3.8431440754522524`*^9}, {3.8431441972752514`*^9, 
   3.8431442255300813`*^9}, {3.843144424511932*^9, 3.843144512352749*^9}, {
   3.8431445455844345`*^9, 3.843144558950224*^9}, {3.843144633390211*^9, 
   3.843144670653101*^9}, {3.8431447587335987`*^9, 3.8431447875959053`*^9}, {
   3.843144833782727*^9, 3.8431448484082413`*^9}, {3.843144908124405*^9, 
   3.8431450604507294`*^9}, {3.843145180097638*^9, 3.8431453751437693`*^9}, 
   3.8431578892868695`*^9, {3.8431712201590643`*^9, 3.843171625090171*^9}, {
   3.8431717652514067`*^9, 3.843172727215042*^9}, {3.8431727923188715`*^9, 
   3.8431729015250454`*^9}, {3.8431729997958126`*^9, 
   3.8431730039882903`*^9}, {3.8431731484041367`*^9, 3.843173193786807*^9}, {
   3.8431732306661463`*^9, 3.843173498170064*^9}, {3.843173534763589*^9, 
   3.843174330676363*^9}, {3.843174362669232*^9, 3.843174577371163*^9}, {
   3.843174884867814*^9, 3.843174916730816*^9}, {3.843174963396497*^9, 
   3.8431749649832325`*^9}, 3.843175043736955*^9, {3.8432053384495106`*^9, 
   3.8432053411906404`*^9}, {3.8448555938205953`*^9, 3.84485561565897*^9}, {
   3.8448556534459877`*^9, 3.8448556546145415`*^9}, {3.845990856263149*^9, 
   3.8459911212562466`*^9}, {3.845991179330063*^9, 3.8459914379104195`*^9}, {
   3.8459915518304644`*^9, 3.8459916135921326`*^9}, {3.845991685978612*^9, 
   3.845991696128011*^9}, {3.8459918120662045`*^9, 3.845991854654458*^9}, 
   3.8459918918769274`*^9, {3.845992017298276*^9, 3.845992039564787*^9}, {
   3.8460832707938623`*^9, 3.846083271629185*^9}, 3.846083545364399*^9, {
   3.847445897651688*^9, 3.8474459249825873`*^9}, 3.8474637153568726`*^9, {
   3.847463789298195*^9, 3.8474637911405196`*^9}, 3.847463850173787*^9, {
   3.8474638911228294`*^9, 3.847463896898093*^9}, {3.847463955368089*^9, 
   3.8474639870899677`*^9}, {3.8474643473283267`*^9, 3.847464361976308*^9}, {
   3.8474644838137317`*^9, 3.847464490009862*^9}, {3.8474646308338423`*^9, 
   3.8474646885705805`*^9}, {3.847464721193225*^9, 3.8474647382884226`*^9}, {
   3.8474647762357883`*^9, 3.8474647790136743`*^9}, {3.847464838057309*^9, 
   3.847464838426826*^9}, {3.8474664117594156`*^9, 3.847466473442554*^9}, {
   3.8474666164643545`*^9, 3.847466695742915*^9}, {3.8474667453267374`*^9, 
   3.8474668055079346`*^9}, {3.8474669898166304`*^9, 3.847467021378753*^9}, {
   3.8474671907239423`*^9, 3.8474672011807413`*^9}, {3.8474798641966085`*^9, 
   3.8474799014206653`*^9}, {3.8474799370808945`*^9, 3.8474799556031756`*^9}, 
   3.847479986067419*^9, {3.847480383156863*^9, 3.8474803951421213`*^9}, 
   3.8474804532478733`*^9, {3.8474805039069242`*^9, 3.8474805082311687`*^9}, {
   3.847480572379405*^9, 3.847480635014147*^9}, {3.847480665621564*^9, 
   3.847480676426589*^9}, {3.8474810529667144`*^9, 3.8474810867188807`*^9}, {
   3.847481146464773*^9, 3.847481208713138*^9}, {3.847481767123787*^9, 
   3.8474817747182755`*^9}, {3.847481831380789*^9, 3.8474818527701693`*^9}, {
   3.8474820148445606`*^9, 3.8474820176470675`*^9}, {3.847482052040635*^9, 
   3.8474820683442545`*^9}, {3.8475362533699636`*^9, 3.847536265990684*^9}, {
   3.847536465401613*^9, 3.847536516386155*^9}, {3.847537174880609*^9, 
   3.847537180456012*^9}, {3.847537269742694*^9, 3.8475373275203714`*^9}, {
   3.8475435465333357`*^9, 3.847543578945837*^9}, 3.8475436465879383`*^9, {
   3.847543696894228*^9, 3.8475437184246607`*^9}, {3.8475437493528996`*^9, 
   3.847543755326868*^9}, 3.847543793152866*^9, {3.8475590179009876`*^9, 
   3.847559031398274*^9}, {3.847559125899132*^9, 3.847559127618015*^9}, {
   3.848068864180808*^9, 3.8480688856492343`*^9}, {3.848068929757105*^9, 
   3.8480689650807047`*^9}},ExpressionUUID->"e41b2265-b8b1-4d68-b2b7-\
ff160635cae3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Obtain probabilities", "Subsection",
 CellChangeTimes->{{3.8459906979037323`*^9, 
  3.845990707031228*^9}},ExpressionUUID->"2b0fb744-630f-41b5-ab52-\
256a79065ade"],

Cell[CellGroupData[{

Cell["Save probability as array", "Subsubsection",
 CellChangeTimes->{{3.8459907101859655`*^9, 3.8459907301267233`*^9}, {
  3.8460824542538233`*^9, 
  3.846082479079743*^9}},ExpressionUUID->"59f0037f-ed08-4fb6-9d69-\
7bdd6d9f6998"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "The", " ", "output", " ", "structure", " ", "is", " ", "unnecessarily", 
    " ", "complicated", " ", "and", " ", "was", " ", "cause", " ", "of", " ", 
    "an", " ", "error", " ", "in", " ", "the", " ", "main", " ", "compute", 
    " ", "loop"}], ",", " ", 
   RowBox[{
   "so", " ", "this", " ", "module", " ", "was", " ", "deprecated", " ", "in",
     " ", "favor", " ", "of", " ", "the", " ", "Function", " ", "version", 
    " ", "of", " ", "the", " ", "same", " ", "code", " ", "written", " ", 
    "immediately", " ", 
    RowBox[{"below", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.846082486125432*^9, 
  3.846082541047332*^9}},ExpressionUUID->"309439dc-1c74-441b-b591-\
01e1065dbabe"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "selected", ",", "selecteds", ",", "ultim", ",", "penultim", ",", 
     "orientation", ",", "prob", ",", "probs", ",", "nsteps"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"probs", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"selecteds", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"probs", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"probs", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"selecteds", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"selecteds", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
           "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"penultim", "=", 
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ultim", "=", 
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"orientation", "=", 
           RowBox[{"OriAnt", "[", 
            RowBox[{"ultim", ",", "penultim"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"prob", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"selected", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"pruned", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
                  "\[Equal]", "t"}], "&"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nsteps", "=", 
                 RowBox[{"t", "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}],
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"prob", "=", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"prob", ",", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"PDF", "[", 
                    RowBox[{"speeddist", ",", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"10", "nsteps"}]], 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}], "]"}]}]}], 
                    "]"}], "nsteps"], "\[IndentingNewLine]", 
                    SuperscriptBox[
                    RowBox[{"PDF", "[", 
                    RowBox[{"avdist", ",", 
                    RowBox[{
                    FractionBox["1", "nsteps"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ArcCos2", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    "selected", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "100"], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    "selected", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "100"]}], "]"}], "-", 
                    "orientation", "+", "\[Pi]"}], ",", 
                    RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], 
                    ")"}]}]}], "]"}], "nsteps"]}]}], " ", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "1", ",", 
                 RowBox[{"Length", "[", "selected", "]"}]}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"probs", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"probs", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "prob"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"selecteds", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"selecteds", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
                "selected"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"pruned", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
                "]"}], "+", "1"}], ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"pruned", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
                "]"}], "+", "11"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"probsout", "=", "probs"}], ";", "\[IndentingNewLine]", 
    RowBox[{"selectedout", "=", "selecteds"}], ";"}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.8423417262392144`*^9, 3.8423417329433413`*^9}, {
  3.8423470383110495`*^9, 3.8423470806452622`*^9}, {3.8423594286889777`*^9, 
  3.8423594719105873`*^9}, {3.842365823151083*^9, 3.842365909766336*^9}, {
  3.842365988214493*^9, 3.8423660093649244`*^9}, {3.8459903543490076`*^9, 
  3.845990366634425*^9}},ExpressionUUID->"4743675b-509d-4645-a8b1-\
0df358f87def"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetProb function", "Subsubsection",
 CellChangeTimes->{{3.8459907380116777`*^9, 
  3.8459907425820513`*^9}},ExpressionUUID->"ab3bc053-0f1f-48e5-b4a0-\
104f28dc177e"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "Uses", " ", "penultimate", " ", "and", " ", "ultimate", " ", "positions", 
    " ", "of", " ", "source", " ", "trajectory", " ", "and", " ", "the", " ", 
    "initial", " ", "position", " ", "of", " ", "target", " ", "trajectory", 
    " ", "to", " ", "compute", " ", "the", " ", "probability", " ", "that", 
    " ", "the", " ", "two", " ", "trajectories", " ", "are", " ", 
    "contiguous", " ", 
    RowBox[{"together", ".", "\[IndentingNewLine]", "As"}], " ", "of", " ", 
    "now"}], ",", " ", 
   RowBox[{
   "the", " ", "function", " ", "requires", " ", "that", " ", "the", " ", 
    "source", " ", "trajectory", " ", "is", " ", "at", " ", "least", " ", 
    "two", " ", "subsequent", " ", "steps", " ", "long", " ", "because", " ", 
    "the", " ", "reliability", " ", "of", " ", "orientation", " ", "obtained",
     " ", "from", " ", "body", " ", "segment", " ", "position", " ", "is", 
    " ", "not", " ", 
    RowBox[{"verified", ".", " ", "Eventually"}], " ", "orientation", " ", 
    "should", " ", "be", " ", "computed", " ", "by", " ", "finding", " ", 
    "direction", " ", "vector", " ", "between", " ", "body", " ", 
    "segments"}], ",", " ", 
   RowBox[{
   "so", " ", "that", " ", "a", " ", "singleton", " ", "trajectory", " ", 
    "can", " ", "be", " ", "integrated", " ", "properly", " ", "as", " ", 
    RowBox[{"well", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8460825512877245`*^9, 
  3.846082720433578*^9}},ExpressionUUID->"c217fd87-d54f-4012-9cc4-\
e19c2ca0dc74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetProb", "[", 
   RowBox[{"source1_", ",", "source_", ",", "target_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"probability", ",", "tdiff", ",", "speed", ",", "angular", ",", 
      RowBox[{"fps", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tdiff", "=", 
      RowBox[{
       RowBox[{
       "target", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
       RowBox[{
       "source", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finds", " ", "probability", " ", "for", " ", "given", " ", 
       "displacement", " ", "over", " ", "tdiff", " ", "frames"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"speed", "=", 
        SuperscriptBox[
         RowBox[{"PDF", "[", 
          RowBox[{"speeddist", ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"10", "tdiff"}]], 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "target", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "source", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "target", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "source", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], ")"}], "2"]}], "]"}]}]}], 
          "]"}], "tdiff"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"speed", "=", 
      RowBox[{"PDF", "[", 
       RowBox[{"deltaspeed", ",", 
        RowBox[{
         FractionBox["2", 
          SuperscriptBox["tdiff", "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"target", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"source", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
               RowBox[{"target", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"source", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}],
             "]"}], "-", 
           RowBox[{"Norm", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"source", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"source1", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
               RowBox[{"source", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"source1", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}],
             "]"}]}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finds", " ", "probability", " ", "for", " ", "given", " ", "angular", 
       " ", "deviation", " ", "over", " ", "tdiff", " ", "frames"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"angular", "=", 
        SuperscriptBox[
         RowBox[{"PDF", "[", 
          RowBox[{"avdist", ",", 
           RowBox[{
            FractionBox["1", "tdiff"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ArcCos2", "[", 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"target", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"source", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "100"], ",", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"target", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"source", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "100"]}], "]"}], "-", 
                 RowBox[{
                 "source", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}], "+", "\[Pi]"}], ",", 
                RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], ")"}]}]}], 
          "]"}], "tdiff"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"angular", "=", 
      SuperscriptBox[
       RowBox[{"PDF", "[", 
        RowBox[{"angularacc", ",", 
         RowBox[{
          FractionBox["2", 
           SuperscriptBox["tdiff", "2"]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"target", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"source", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{"target", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"source", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
                   "]"}]}], "-", 
                 RowBox[{
                 "source1", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], ")"}], "+", "\[Pi]"}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], ")"}]}]}], 
        "]"}], "tdiff"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiply", " ", "the", " ", "two"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"probability", "=", " ", 
      RowBox[{"speed", " ", "angular"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "probability", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.845989869390294*^9, 3.84598992517901*^9}, {
   3.845989972498325*^9, 3.8459901388634205`*^9}, {3.8459902132094736`*^9, 
   3.8459902316572437`*^9}, {3.845990291204687*^9, 3.845990336155431*^9}, {
   3.845990397601123*^9, 3.8459904430586596`*^9}, {3.845990479147199*^9, 
   3.8459904829323215`*^9}, {3.8459905214443717`*^9, 
   3.8459905472336802`*^9}, {3.8459905887000313`*^9, 3.845990687697744*^9}, {
   3.846082734244336*^9, 3.846082810637003*^9}, {3.847556242517192*^9, 
   3.8475562643037543`*^9}, {3.847556396446426*^9, 3.8475564395086126`*^9}, {
   3.847556506974451*^9, 3.8475565146881375`*^9}, {3.8475565468132915`*^9, 
   3.847556597505801*^9}, {3.8475569386197*^9, 3.847556942296486*^9}, {
   3.847557030392497*^9, 3.8475570428235364`*^9}, 3.847557078043311*^9, {
   3.847558672149685*^9, 3.8475586826044836`*^9}, {3.847558872657671*^9, 
   3.847558893127703*^9}, {3.8477925920869694`*^9, 3.8477926076263704`*^9}, {
   3.8477926825111303`*^9, 3.8477926849202137`*^9}, 3.8477982026549854`*^9, {
   3.847798238101203*^9, 3.847798242400462*^9}, {3.847798935201835*^9, 
   3.847798942731429*^9}, {3.847806668963729*^9, 3.8478066777898283`*^9}, {
   3.847806735470971*^9, 3.8478067442198267`*^9}, 3.8478069940934362`*^9, {
   3.8478070324136753`*^9, 3.8478070500139866`*^9}, {3.847807662756239*^9, 
   3.8478076629375286`*^9}, {3.847807724890946*^9, 3.8478077255289574`*^9}, {
   3.8478080063447456`*^9, 3.8478080323184566`*^9}, {3.8478082406479006`*^9, 
   3.8478082441468353`*^9}, {3.847808282809225*^9, 3.8478082832956977`*^9}, {
   3.8478083990852966`*^9, 3.8478084322649803`*^9}, 3.8478095661206098`*^9, {
   3.847809668334814*^9, 3.8478096803671775`*^9}, {3.847809792439699*^9, 
   3.8478097932808037`*^9}, {3.8479761114548616`*^9, 
   3.8479761208412123`*^9}, {3.847976949486671*^9, 3.847976963171363*^9}, {
   3.8479858250686255`*^9, 3.847985825654772*^9}, {3.847985878370225*^9, 
   3.8479858976734247`*^9}, {3.847985975203625*^9, 3.847985975573425*^9}, {
   3.8480682974934587`*^9, 3.8480683507398*^9}, {3.8480684375380445`*^9, 
   3.848068441436753*^9}, {3.8480686913732777`*^9, 3.848068706520741*^9}, {
   3.8480691189779005`*^9, 3.8480691431127367`*^9}, 3.84806920542108*^9, {
   3.848070978870488*^9, 3.8480709790784903`*^9}, {3.848071073892346*^9, 
   3.848071074346751*^9}, {3.8480726484033647`*^9, 3.8480726652871637`*^9}, {
   3.8480727131032906`*^9, 3.8480727170443473`*^9}, {3.8480732556739593`*^9, 
   3.848073277456739*^9}, {3.8491054723590546`*^9, 3.849105473662897*^9}, {
   3.8491059031643705`*^9, 3.8491059076565027`*^9}, {3.8491062635913963`*^9, 
   3.849106299018488*^9}, {3.849106359637532*^9, 3.8491063623648815`*^9}, {
   3.8491065678377056`*^9, 3.849106571825495*^9}, 3.8491067791345315`*^9, {
   3.8491069407312136`*^9, 3.8491069452964773`*^9}, {3.849107049625124*^9, 
   3.84910705296334*^9}},ExpressionUUID->"bb6cac3a-5301-42bb-a2eb-\
7e6308ad5d15"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Join trajectories", "Section",
 CellChangeTimes->{{3.842366961281951*^9, 
  3.842366967457004*^9}},ExpressionUUID->"a22f65c3-d485-4bde-a2ce-\
7ebfa7873fee"],

Cell[CellGroupData[{

Cell["Pick maximum", "Subsection",
 CellChangeTimes->{{3.8423669708334723`*^9, 3.8423669784811907`*^9}, {
  3.8423670350398693`*^9, 3.8423670650397577`*^9}, {3.842377639195448*^9, 
  3.842377641235421*^9}},ExpressionUUID->"f578d3d2-95d1-42a7-a690-\
dd518177b5b5"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sources", ",", "targets", ",", "linklabel", ",", "linked", ",", 
     RowBox[{"pthresh", "=", "0.0000000000001"}], ",", "\[IndentingNewLine]", 
     RowBox[{"cutoff", "=", "3"}]}], "\[IndentingNewLine]", "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"joined", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"algorithm", ":", "\[IndentingNewLine]", " ", 
       RowBox[{
       "1.", " ", "Iterate", " ", "through", " ", "each", " ", "frame", 
        "\[IndentingNewLine]", "2.", " ", "At", " ", "the", " ", "given", " ",
         "frame"}]}], ",", " ", 
      RowBox[{
      "look", " ", "for", " ", "all", " ", "trajectories", " ", "that", " ", 
       "end", " ", "at", " ", "that", " ", 
       RowBox[{"time", ".", "\[IndentingNewLine]", "3."}], " ", "At", " ", 
       "the", " ", "subsequent", " ", "frame"}], ",", " ", 
      RowBox[{
      "look", " ", "for", " ", "all", " ", "trajectories", " ", "that", " ", 
       "begin", " ", "at", " ", "that", " ", 
       RowBox[{"time", ".", "\[IndentingNewLine]", "4."}], " ", "For", " ", 
       "each", " ", "target"}], ",", " ", 
      RowBox[{
      "find", " ", "the", " ", "source", " ", "that", " ", "has", " ", "best",
        " ", "likelihood", " ", "for", " ", "the", " ", 
       RowBox[{"target", ".", "\[IndentingNewLine]", "5."}], " ", "Repeat", 
       " ", "until", " ", "all", " ", "targets", " ", "are", " ", 
       RowBox[{"assigned", ".", "\[IndentingNewLine]", "6."}], " ", "Proceed",
        " ", "to", " ", "the", " ", "next", " ", "frame"}], ",", " ", 
      RowBox[{
      "carrying", " ", "over", " ", "any", " ", "unmatched", " ", 
       "trajectory", " ", "from", " ", "previous", " ", 
       RowBox[{"frame", ".", "\[IndentingNewLine]", "7."}], " ", "If", " ", 
       "a", " ", "trajectory", " ", "termination", " ", "point", " ", "goes", 
       " ", "unmatched", " ", "for", " ", "longer", " ", "than", " ", "5", 
       " ", "frames"}], ",", " ", 
      RowBox[{"remove", " ", "it", " ", "from", " ", "the", " ", 
       RowBox[{"trajectories", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sources", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"targets", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"assign", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Comment", " ", "out", " ", "the", " ", "following", " ", "two", " ", 
         "lines", " ", "to", " ", "make", " ", "the", " ", 
         RowBox[{"source", "/", "target"}], " ", "lists", " ", "cumulative"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "sources"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sources", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"sources", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"pruned", "\[LeftDoubleBracket]", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
                ">", 
                RowBox[{"t", "-", "cutoff"}]}], "&"}]}], "]"}]}]}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"targets", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Add", " ", "candidates", " ", "to", " ", "sources", " ", "list"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pruned", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "t"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                 "pruned", "\[LeftDoubleBracket]", "n", 
                  "\[RightDoubleBracket]"}], "]"}], ">", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"sources", ",", "n"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Add", " ", "candidates", " ", "to", " ", "targets", " ", "list"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pruned", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", 
             RowBox[{"t", "+", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"targets", ",", "n"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Perform", " ", "linear", " ", "assignment", " ", "using", " ", 
         "Hungarian", " ", "Algorithm"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Length", "[", "sources", "]"}], ",", 
            RowBox[{"Length", "[", "targets", "]"}]}], "]"}], ">", "0"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"assign", "=", 
           RowBox[{"Hungarian", "[", 
            RowBox[{"sources", ",", "targets"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Length", "@", "sources"}], ",", 
                 RowBox[{"Length", "@", "targets"}]}], "}"}], "]"}], "-", 
              RowBox[{"Length", "@", "assign"}]}], "\[NotEqual]", "0"}], ",", 
            RowBox[{"Print", "[", "t", "]"}]}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Join", " ", "trajectories", " ", "and", " ", "remove", " ", 
         "redundancy"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sourceremove", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"targetremove", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"assign", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "3"}], "\[RightDoubleBracket]"}], ">", 
             "pthresh"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Filter", " ", "out", " ", "matches", " ", 
                RowBox[{"involving", " ", "'"}], 
                RowBox[{"padded", "'"}], " ", "positions", " ", "inserted", 
                " ", "to", " ", "make", " ", "square", " ", "matrix"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"assign", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], 
                  "\[LessEqual]", 
                  RowBox[{"Length", "@", "sources"}]}], ")"}], "&&", 
                RowBox[{
                 RowBox[{"assign", "\[LeftDoubleBracket]", 
                  RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], 
                 "\[LessEqual]", 
                 RowBox[{"Length", "@", "targets"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Join", " ", "target", " ", "to", " ", "source", " ", "to", 
                 " ", "target", " ", "and", " ", "form", " ", "longer", " ", 
                 "trajectory"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sources", "\[LeftDoubleBracket]", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"targets", "\[LeftDoubleBracket]", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                   "}"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"joined", ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"sources", "\[LeftDoubleBracket]", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"targets", "\[LeftDoubleBracket]", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Remove", " ", "source", " ", "from", " ", "list", " ", "of",
                   " ", "candidates"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"sourceremove", ",", 
                  RowBox[{"assign", "\[LeftDoubleBracket]", 
                   RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"targetremove", ",", 
                  RowBox[{"targets", "\[LeftDoubleBracket]", 
                   RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"pruned", "\[LeftDoubleBracket]", 
                  RowBox[{"sources", "\[LeftDoubleBracket]", 
                   RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"sources", "\[LeftDoubleBracket]", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"targets", "\[LeftDoubleBracket]", 
                    RowBox[{"assign", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "assign", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Remove", " ", "original", " ", "copy", " ", "of", " ", "targets"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "sourceremove"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sourceremove", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "#", "}"}], "&"}], "/@", "sourceremove"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sources", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"sources", ",", "sourceremove"}], "]"}]}]}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "targetremove"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "sources", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ">", 
               RowBox[{
               "targets", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
               RowBox[{
               "sources", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "-=", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "sources"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", "targetremove"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"targetremove", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "#", "}"}], "&"}], "/@", "targetremove"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pruned", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"pruned", ",", "targetremove"}], "]"}]}]}]}], "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"Max", "@", "frames"}]}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.842367075233349*^9, 3.84236709176763*^9}, {
   3.8423671439428406`*^9, 3.842367164982051*^9}, {3.842377631340774*^9, 
   3.842377649396534*^9}, {3.8423776871810546`*^9, 3.842377707885271*^9}, {
   3.842377739094367*^9, 3.842377741190792*^9}, {3.8423778257369723`*^9, 
   3.8423779314839735`*^9}, {3.842377989828365*^9, 3.8423780196537*^9}, {
   3.8423785905711565`*^9, 3.84237863477236*^9}, {3.842379263579195*^9, 
   3.842379338717471*^9}, {3.842379371526156*^9, 3.8423794119908104`*^9}, {
   3.842379462656977*^9, 3.8423796499989758`*^9}, {3.8423796806859536`*^9, 
   3.842379748317932*^9}, {3.8423798654358177`*^9, 3.842379905523914*^9}, {
   3.8423799491478987`*^9, 3.8423799502905054`*^9}, {3.8423800898898616`*^9, 
   3.842380105367362*^9}, {3.8423801493913803`*^9, 3.8423801548395557`*^9}, {
   3.8426958552505455`*^9, 3.842695868144969*^9}, {3.8426967428125105`*^9, 
   3.842696772660661*^9}, {3.842696965939597*^9, 3.8426969692654886`*^9}, 
   3.8427082681530046`*^9, {3.8427092064202003`*^9, 3.8427092068361845`*^9}, {
   3.842710831845423*^9, 3.842710834864534*^9}, {3.8427109492736645`*^9, 
   3.84271095914083*^9}, {3.8427110501092157`*^9, 3.842711075774621*^9}, {
   3.8427113469645443`*^9, 3.8427114223928967`*^9}, {3.8431220356406436`*^9, 
   3.843122079473241*^9}, {3.843131298168745*^9, 3.8431312983277383`*^9}, {
   3.8431315711920977`*^9, 3.843131586754629*^9}, 3.8431329822089915`*^9, {
   3.8431333805632324`*^9, 3.8431334168013873`*^9}, {3.8431435359027953`*^9, 
   3.84314354007874*^9}, {3.8431448769801235`*^9, 3.8431448931691923`*^9}, {
   3.8431456157242002`*^9, 3.843145655432989*^9}, 3.843171228488222*^9, {
   3.843174975019228*^9, 3.84317499618643*^9}, {3.8431750695527153`*^9, 
   3.8431750707305555`*^9}, {3.8448553328899713`*^9, 3.844855359003524*^9}, {
   3.8448554115821395`*^9, 3.8448554612094717`*^9}, {3.844855969901194*^9, 
   3.8448560047747655`*^9}, {3.8448560657909126`*^9, 3.844856089699471*^9}, {
   3.844856409750365*^9, 3.8448564601114073`*^9}, {3.8448564994672565`*^9, 
   3.844856537052683*^9}, {3.845989573296729*^9, 3.845989574734412*^9}, 
   3.8459907588892355`*^9, {3.8459907910669537`*^9, 3.8459908141568565`*^9}, {
   3.8459914662010894`*^9, 3.8459914879200706`*^9}, {3.8459917744686956`*^9, 
   3.845991774677749*^9}, {3.8459920462370896`*^9, 3.8459922125410132`*^9}, {
   3.846082844958623*^9, 3.8460829106208444`*^9}, {3.846083184150676*^9, 
   3.8460832463933773`*^9}, {3.8460834055189533`*^9, 3.846083441580345*^9}, {
   3.8460835496545763`*^9, 3.846083549975072*^9}, {3.8460836744692917`*^9, 
   3.8460836745890937`*^9}, {3.847466752023532*^9, 3.8474667537466145`*^9}, {
   3.8474812158132043`*^9, 3.8474812339693203`*^9}, {3.8474812699771996`*^9, 
   3.84748140824957*^9}, {3.847481470147822*^9, 3.8474815076835585`*^9}, {
   3.847481553883067*^9, 3.8474816370603104`*^9}, {3.847481669235973*^9, 
   3.8474816910849204`*^9}, {3.8474817303053417`*^9, 3.847481742475502*^9}, {
   3.8474820764760475`*^9, 3.8474821258096848`*^9}, {3.847536042990609*^9, 
   3.8475361832965384`*^9}, 3.8475365233769283`*^9, {3.8475371903046584`*^9, 
   3.8475372249292865`*^9}, {3.8475373514970264`*^9, 3.847537390366414*^9}, {
   3.847537454866892*^9, 3.847537562421474*^9}, {3.8475379886143703`*^9, 
   3.847538066859789*^9}, {3.847541540285596*^9, 3.847541546362359*^9}, {
   3.8475422622636604`*^9, 3.847542375219037*^9}, {3.8475425941255913`*^9, 
   3.8475426173330016`*^9}, {3.8475426521111603`*^9, 
   3.8475427641801167`*^9}, {3.847542806709859*^9, 3.847542956036064*^9}, {
   3.8475431206456275`*^9, 3.8475431708889284`*^9}, {3.847543216908346*^9, 
   3.8475432396264825`*^9}, {3.847543379300185*^9, 3.847543478765877*^9}, {
   3.847543510412095*^9, 3.8475435147997785`*^9}, {3.8475436254330125`*^9, 
   3.847543633512539*^9}, {3.847543783977154*^9, 3.8475438775737553`*^9}, {
   3.8475477683622217`*^9, 3.847547798653302*^9}, {3.8475483050434837`*^9, 
   3.8475483258313403`*^9}, {3.8475484351892443`*^9, 3.84754843543672*^9}, {
   3.8475486867129602`*^9, 3.8475487040989447`*^9}, {3.847548738018239*^9, 
   3.8475487381814365`*^9}, {3.8475489116122265`*^9, 3.847548968880533*^9}, {
   3.847549001886234*^9, 3.8475490020021896`*^9}, 3.8475490631816473`*^9, {
   3.8475491752881975`*^9, 3.8475491795186462`*^9}, {3.847549331140094*^9, 
   3.847549392773316*^9}, {3.847549502971819*^9, 3.847549547499649*^9}, {
   3.847549706995264*^9, 3.8475497128692923`*^9}, {3.847549796889573*^9, 
   3.84754979712821*^9}, {3.847549846103959*^9, 3.847549916457284*^9}, {
   3.8475499505102963`*^9, 3.8475499578977118`*^9}, {3.8475500075396214`*^9, 
   3.847550009947848*^9}, {3.847550052896443*^9, 3.8475500539006786`*^9}, {
   3.8475501009182034`*^9, 3.8475501020601864`*^9}, {3.8475501329042063`*^9, 
   3.8475501657567806`*^9}, {3.8475502045863132`*^9, 3.847550210692233*^9}, {
   3.847550518460574*^9, 3.847550530920227*^9}, {3.8475505971279984`*^9, 
   3.847550598193792*^9}, {3.8475506420621524`*^9, 3.847550685953302*^9}, {
   3.847550725911183*^9, 3.847550785431158*^9}, {3.8475519635416775`*^9, 
   3.847551975539469*^9}, {3.8475520336194887`*^9, 3.847552035225613*^9}, {
   3.847552069688011*^9, 3.8475520769168105`*^9}, {3.847552189857725*^9, 
   3.847552276824112*^9}, {3.847552451484231*^9, 3.8475524824267282`*^9}, {
   3.8475539419929276`*^9, 3.8475539522785807`*^9}, 3.8475540510769224`*^9, {
   3.84755414716394*^9, 3.8475541473646336`*^9}, 3.847554243329291*^9, {
   3.847554317112156*^9, 3.8475543356485224`*^9}, {3.8475543664651914`*^9, 
   3.847554371894659*^9}, {3.8475544773334184`*^9, 3.8475544777888374`*^9}, {
   3.8475545084820924`*^9, 3.847554508604289*^9}, {3.8475545901091204`*^9, 
   3.8475546184733167`*^9}, {3.8475546496200066`*^9, 3.8475546781589513`*^9}, 
   3.847554734391219*^9, {3.84755484294793*^9, 3.8475548433335013`*^9}, {
   3.847554996554433*^9, 3.8475549971571465`*^9}, {3.8475551010502777`*^9, 
   3.847555101166227*^9}, {3.847555151806445*^9, 3.8475551659557467`*^9}, {
   3.847555266200781*^9, 3.8475552670049496`*^9}, {3.8475553264707394`*^9, 
   3.8475553265554304`*^9}, {3.8475554532912908`*^9, 3.847555453592209*^9}, {
   3.8475555473127937`*^9, 3.8475555480216675`*^9}, {3.847555586276353*^9, 
   3.8475555863232393`*^9}, 3.8475586384512453`*^9, {3.847558822836568*^9, 
   3.8475588266715903`*^9}, {3.8475589595581465`*^9, 3.847558964570122*^9}, {
   3.8475591187074256`*^9, 3.8475591411249256`*^9}, {3.8477925618555503`*^9, 
   3.8477925620078473`*^9}, {3.847792642748971*^9, 3.8477926640130587`*^9}, {
   3.8477927079020443`*^9, 3.8477927112122*^9}, {3.847792749786055*^9, 
   3.847792782164914*^9}, {3.847792909617485*^9, 3.8477929491020727`*^9}, {
   3.847792992387144*^9, 3.847793022949896*^9}, {3.84779306773415*^9, 
   3.847793146768615*^9}, {3.847793227396964*^9, 3.8477932833775787`*^9}, {
   3.847793314919489*^9, 3.8477933923666573`*^9}, {3.8477934688735504`*^9, 
   3.847793595033643*^9}, {3.8477936315243263`*^9, 3.847793716987448*^9}, {
   3.84779374785485*^9, 3.84779381261679*^9}, {3.8477938613668346`*^9, 
   3.847793931626254*^9}, {3.8477939930831738`*^9, 3.8477940257958956`*^9}, {
   3.847794249222603*^9, 3.847794495829625*^9}, {3.847794539497652*^9, 
   3.8477945676887083`*^9}, {3.8477946191543837`*^9, 
   3.8477946203956966`*^9}, {3.84779470616541*^9, 3.847794750749527*^9}, {
   3.8477948036143*^9, 3.8477949615862045`*^9}, {3.84779507171865*^9, 
   3.8477950985774913`*^9}, {3.847795144400498*^9, 3.8477951570759616`*^9}, {
   3.8477952099581604`*^9, 3.8477954571325846`*^9}, {3.8477955103183684`*^9, 
   3.8477955570375423`*^9}, {3.847795589941783*^9, 3.8477956019867024`*^9}, 
   3.8477956410697613`*^9, {3.847795739038302*^9, 3.8477957571943827`*^9}, {
   3.847795803208742*^9, 3.847795857316944*^9}, {3.847795945453393*^9, 
   3.8477959605744085`*^9}, {3.8477960269496145`*^9, 
   3.8477960302787075`*^9}, {3.8477960964619565`*^9, 3.847796136314576*^9}, {
   3.8477962392177706`*^9, 3.8477962471665215`*^9}, {3.847796279657527*^9, 
   3.8477962829165473`*^9}, {3.8477963331245236`*^9, 3.847796339145426*^9}, {
   3.847796405208745*^9, 3.8477964060264807`*^9}, 3.847796455659585*^9, 
   3.8477964973103137`*^9, {3.847796528082464*^9, 3.847796535254908*^9}, {
   3.8477969264566555`*^9, 3.8477969415052414`*^9}, {3.847797045493029*^9, 
   3.8477970534057245`*^9}, {3.84779712229005*^9, 3.847797184874175*^9}, {
   3.847797227153123*^9, 3.847797242024641*^9}, {3.847797277756796*^9, 
   3.847797279774581*^9}, {3.847797460056965*^9, 3.847797473414412*^9}, {
   3.847797635595122*^9, 3.8477976391072187`*^9}, {3.8477977327754574`*^9, 
   3.847797766710703*^9}, {3.847797876546292*^9, 3.8477978874209857`*^9}, {
   3.847797922683354*^9, 3.8477979230692425`*^9}, {3.8477979908299503`*^9, 
   3.847797992000951*^9}, {3.847798030195166*^9, 3.8477980425387597`*^9}, {
   3.8477980756722727`*^9, 3.8477980757947016`*^9}, 3.8477981310661983`*^9, {
   3.8477981635229893`*^9, 3.84779816505941*^9}, {3.8477982232018423`*^9, 
   3.8477982233643336`*^9}, {3.8477982561401277`*^9, 3.847798274441311*^9}, 
   3.8477983077518826`*^9, 3.8477983389242616`*^9, {3.847798372440511*^9, 
   3.8477983726447763`*^9}, {3.847798467199606*^9, 3.8477984673468885`*^9}, {
   3.8477985046875706`*^9, 3.8477985048415985`*^9}, {3.847798601802902*^9, 
   3.847798601871978*^9}, 3.847798639486199*^9, {3.8477986773024426`*^9, 
   3.8477986775187006`*^9}, 3.8477987107343793`*^9, {3.847798777039714*^9, 
   3.8477987772715764`*^9}, {3.8477988084168406`*^9, 3.8477988085171175`*^9}, 
   3.8477988410166454`*^9, {3.847798882247227*^9, 3.8477988825480633`*^9}, {
   3.847798996388651*^9, 3.8477989965204344`*^9}, {3.84780559693353*^9, 
   3.8478055970495157`*^9}, 3.8478056667082863`*^9, {3.8478057093146877`*^9, 
   3.8478057094619246`*^9}, {3.8478058127107244`*^9, 3.8478058130433035`*^9}, 
   3.847810165201866*^9, {3.8479763543434343`*^9, 3.8479763575712624`*^9}, {
   3.84797641212847*^9, 3.847976412599442*^9}, {3.847976455191531*^9, 
   3.8479764557247467`*^9}, {3.8479765515386524`*^9, 3.847976552002944*^9}, {
   3.847977576358389*^9, 3.8479775778949685`*^9}, {3.8479776252168975`*^9, 
   3.847977625941865*^9}, {3.8479776560296373`*^9, 3.847977656220711*^9}, {
   3.8479776866827073`*^9, 3.847977686821089*^9}, {3.8479777169749417`*^9, 
   3.847977717137353*^9}, {3.847977747418702*^9, 3.8479777475503254`*^9}, {
   3.8479777799199343`*^9, 3.8479777802903996`*^9}, {3.8479778148318796`*^9, 
   3.8479778453262563`*^9}, {3.847978026196087*^9, 3.847978044408831*^9}, {
   3.8479780897125454`*^9, 3.8479781581847095`*^9}, {3.847978243649191*^9, 
   3.8479782461108174`*^9}, {3.8479804604534235`*^9, 3.847980461727524*^9}, {
   3.8479804981375694`*^9, 3.847980498855791*^9}, 3.847980532976032*^9, {
   3.8479814355744553`*^9, 3.8479814942936583`*^9}, {3.847981532079485*^9, 
   3.847981588902444*^9}, {3.8479820999766197`*^9, 3.8479821022626038`*^9}, {
   3.8479828616958046`*^9, 3.847982880281221*^9}, {3.847982960049655*^9, 
   3.8479829601809783`*^9}, {3.847983015786866*^9, 3.84798301587155*^9}, {
   3.847983064344736*^9, 3.847983064947113*^9}, {3.8479831301365185`*^9, 
   3.847983130268196*^9}, {3.8479831890338945`*^9, 3.8479831891109257`*^9}, {
   3.8479832679188356`*^9, 3.8479832680506744`*^9}, {3.847983344025443*^9, 
   3.84798334414106*^9}, {3.84798339591156*^9, 3.847983398337059*^9}, {
   3.847983448934323*^9, 3.847983449119539*^9}, {3.847983510690975*^9, 
   3.8479835108065643`*^9}, {3.847983591902461*^9, 3.8479835920566187`*^9}, {
   3.847983634329294*^9, 3.847983635433978*^9}, {3.8479836800989656`*^9, 
   3.847983683560348*^9}, {3.8479837552022953`*^9, 3.847983755302642*^9}, {
   3.8479860386852818`*^9, 3.847986039388415*^9}, {3.847986140810749*^9, 
   3.84798614124967*^9}, 3.847986205554137*^9, {3.847986284681514*^9, 
   3.847986284951393*^9}, {3.8479863585710373`*^9, 3.8479863586492167`*^9}, {
   3.847986416271618*^9, 3.8479864163877745`*^9}, {3.8479864742342763`*^9, 
   3.8479864743189416`*^9}, {3.8479865213258333`*^9, 
   3.8479865214417076`*^9}, {3.847986587544421*^9, 3.8479865877765374`*^9}, {
   3.8479866838148465`*^9, 3.8479866839934216`*^9}, 3.8479867524050684`*^9, {
   3.8479869308677187`*^9, 3.8479869338648653`*^9}, {3.8479869966412773`*^9, 
   3.8479870361996737`*^9}, {3.847987066610114*^9, 3.847987243974271*^9}, {
   3.847987275097148*^9, 3.8479873233083935`*^9}, {3.8479873548299947`*^9, 
   3.847987487230497*^9}, {3.8479875854853735`*^9, 3.8479875856238203`*^9}, {
   3.847987658142516*^9, 3.847987658296412*^9}, {3.8479876923115325`*^9, 
   3.847987693378028*^9}, {3.847987746809723*^9, 3.8479877468944254`*^9}, {
   3.847987801676111*^9, 3.847987801823736*^9}, {3.8479878670837317`*^9, 
   3.8479878675388937`*^9}, {3.8479879478581095`*^9, 3.8479880086922045`*^9}, 
   3.8479880394885664`*^9, {3.8479880890462666`*^9, 3.8479880898550434`*^9}, {
   3.8480544605431447`*^9, 3.848054461414549*^9}, {3.8480544954184933`*^9, 
   3.8480544962906847`*^9}, {3.848054534689581*^9, 3.848054535153964*^9}, 
   3.8480545689986567`*^9, 3.8480687636831493`*^9, {3.848068800601158*^9, 
   3.8480688010339994`*^9}, {3.848068919485877*^9, 3.848068919961791*^9}, 
   3.8480692268012185`*^9, {3.8480717713653765`*^9, 3.848071812169298*^9}, {
   3.848071849487331*^9, 3.8480718502127676`*^9}, {3.84807191611789*^9, 
   3.848071916245895*^9}, {3.8480719478667693`*^9, 3.8480720945133343`*^9}, {
   3.848074960156747*^9, 3.84807504920243*^9}, 
   3.848664757453597*^9},ExpressionUUID->"3fb5be7c-0935-4534-a35d-\
ab28e8897786"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"pruned", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"587", ";;", "590"}], ",", ";;", ",", "2", ",", 
        RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Orange"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "xmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "ymax"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"pruned", "\[LeftDoubleBracket]", 
       RowBox[{"331", ",", ";;", ",", 
        RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8475377309466124`*^9, 3.847537978122892*^9}, {
  3.8475478699091673`*^9, 3.847548114169737*^9}, {3.847548225729621*^9, 
  3.8475482793886967`*^9}, {3.8475483326361656`*^9, 3.8475483407881007`*^9}, {
  3.847548442324023*^9, 3.8475484661256466`*^9}, {3.847549011403056*^9, 
  3.847549083927106*^9}, {3.8475491158204536`*^9, 3.8475491383794284`*^9}, {
  3.847550285506055*^9, 3.847550313491062*^9}, {3.847550383510764*^9, 
  3.847550496414509*^9}, {3.8475520143284106`*^9, 3.8475520186089964`*^9}, {
  3.8479805846393747`*^9, 3.847980594124276*^9}, {3.8479838589963846`*^9, 
  3.8479839991676626`*^9}, {3.8479868402433553`*^9, 3.847986851609232*^9}, {
  3.847988730565076*^9, 3.8479888237022305`*^9}, {3.8480711034672956`*^9, 
  3.8480712042285295`*^9}, {3.8480733536760416`*^9, 
  3.8480733657860622`*^9}},ExpressionUUID->"4f40c0d8-7739-495d-923d-\
708f88d081cd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert format and export", "Section",
 CellChangeTimes->{{3.848654649841196*^9, 
  3.848654657214919*^9}},ExpressionUUID->"c5d5ba60-3e56-46f2-87e9-\
2ed7be7dcda5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"export", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
           "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[Equal]", "t"}], "&"}]}], "]"}]}], ">", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
            "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[Equal]", "t"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
            "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[Equal]", "t"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", 
       RowBox[{"Length", "@", "pruned"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "1", ",", 
       RowBox[{"Max", "[", "frames", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8486549336236534`*^9, 3.848655044898139*^9}, {
   3.8486552498903046`*^9, 3.848655254913475*^9}, {3.8486552933071613`*^9, 
   3.8486553801443357`*^9}, {3.848655476820448*^9, 3.8486554854094377`*^9}, {
   3.8486555268382673`*^9, 3.848655559392669*^9}, {3.848655613535301*^9, 
   3.848655614755887*^9}, {3.8486558177150197`*^9, 3.848655858797433*^9}, 
   3.8486560111225967`*^9, {3.848656144775679*^9, 3.84865616219652*^9}, {
   3.8486563410748405`*^9, 3.848656343323183*^9}, {3.848656828990275*^9, 
   3.84865685414423*^9}, {3.848657014086689*^9, 
   3.8486570168426995`*^9}},ExpressionUUID->"a8594616-77ed-4fab-bd74-\
8a91ee3889db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"export", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{
       "export", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], ",", 
       "Null"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", 
       RowBox[{"Length", "@", "pruned"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.848656386864644*^9, 3.8486564575440884`*^9}, {
   3.8486564993854213`*^9, 3.8486565022602253`*^9}, 3.848656543254624*^9, {
   3.8486569366742845`*^9, 3.8486569372337112`*^9}, {3.8486570731619844`*^9, 
   3.8486570738046956`*^9}},ExpressionUUID->"4fd2c932-e57f-4424-9bd2-\
65b1262fa8d4"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<fixed.h5\>\"", ",", "export", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Datasets\>\"", ",", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "export"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.84865715468638*^9, 3.848657202569461*^9}, {
  3.848657259545804*^9, 3.8486573101772594`*^9}, {3.8486573639792476`*^9, 
  3.848657368959755*^9}, {3.8486574828459277`*^9, 3.848657488953686*^9}, {
  3.8486575287946577`*^9, 
  3.8486575401009197`*^9}},ExpressionUUID->"97c471d0-3c80-4b4f-bd23-\
b352ceec5e3c"],

Cell[BoxData["."], "Input",
 CellChangeTimes->{
  3.8486573793222604`*^9},ExpressionUUID->"63c00079-326d-4ea7-afad-\
95be0ee5e491"],

Cell[BoxData[
 RowBox[{"Length", "@", "export"}]], "Input",
 CellChangeTimes->{{3.8486572157097282`*^9, 
  3.848657217634774*^9}},ExpressionUUID->"cc7203c6-b01b-4cf7-aaf4-\
7e0770d30ba8"],

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{
  "export", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.848657218902489*^9, 
  3.848657253171713*^9}},ExpressionUUID->"98ead5e3-717c-4934-bfc5-\
b4585a519e72"],

Cell[BoxData[
 RowBox[{"Range", "@", 
  RowBox[{"Length", "@", "export"}]}]], "Input",
 CellChangeTimes->{{3.848657315427496*^9, 
  3.8486573186175995`*^9}},ExpressionUUID->"8fa2c250-4beb-4b50-bd11-\
eb9f5e8f729a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"-", "0.3"}]}], ";", 
  RowBox[{"b", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArcTan", "[", 
   RowBox[{"a", ",", "b"}], "]"}], "+", 
  RowBox[{"ArcCos2", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8491068935217867`*^9, 
  3.8491069319624095`*^9}},ExpressionUUID->"e285193c-56cd-4798-81db-\
15edb95be3de"]
}, Open  ]]
},
WindowSize->{958, 978},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 154, 3, 73, "Section",ExpressionUUID->"dcbafb6b-b5d1-4aef-a1af-e08110c8a072"],
Cell[737, 27, 236, 6, 32, "Input",ExpressionUUID->"9f4752f4-7cb7-4a36-8aa3-c8420979ee27"],
Cell[CellGroupData[{
Cell[998, 37, 165, 3, 59, "Subsection",ExpressionUUID->"46a17531-5b19-4860-9496-e39ec32aacc0"],
Cell[1166, 42, 585, 14, 55, "Input",ExpressionUUID->"f0f9a852-5092-4a41-be8c-94481b2c9e8c"],
Cell[1754, 58, 345, 6, 32, "Input",ExpressionUUID->"25ce2295-9b5f-4d54-8802-4cbc1ea62308"],
Cell[2102, 66, 290, 8, 32, "Input",ExpressionUUID->"0ba2456c-30c4-4aae-9952-15dc3327f819"],
Cell[2395, 76, 226, 6, 32, "Input",ExpressionUUID->"d729cc21-48c1-46a2-a5b0-c10f73cfbbf3"],
Cell[2624, 84, 385, 11, 80, "Input",ExpressionUUID->"1e238cbe-e63c-464e-8c4b-a74e3d7ac8b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3046, 100, 92, 0, 59, "Subsection",ExpressionUUID->"d2ca4549-765b-46dd-bd72-f64b1f72cdc4"],
Cell[3141, 102, 1393, 34, 308, "Input",ExpressionUUID->"5104f5ad-d60e-4f4d-a5bb-c13dcd473a13"],
Cell[4537, 138, 1825, 48, 308, "Input",ExpressionUUID->"579f54c2-c2f2-40ca-a66a-4e4c393d2d2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6399, 191, 184, 3, 59, "Subsection",ExpressionUUID->"5534d867-59e6-48ef-be4a-086d7d496005"],
Cell[6586, 196, 747, 13, 77, "Input",ExpressionUUID->"dd480c16-9207-4112-a2f3-f23598b15bd7"],
Cell[7336, 211, 46697, 841, 161, "Input",ExpressionUUID->"f6f02074-4d50-4345-9e8a-29d237b0a494"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54070, 1057, 158, 3, 59, "Subsection",ExpressionUUID->"1cf4057e-f27b-4823-a73b-c98aee6da8f9"],
Cell[54231, 1062, 12916, 288, 1382, "Input",ExpressionUUID->"20cf3692-e54b-4ded-9e67-b6011406eec6"],
Cell[67150, 1352, 465, 10, 32, "Input",ExpressionUUID->"16a073b9-ff1b-4900-927f-ced31a09f030"],
Cell[67618, 1364, 268, 6, 32, "Input",ExpressionUUID->"900e4c3b-7c72-4b17-b492-b36950c1aede"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[67935, 1376, 109, 0, 57, "Section",ExpressionUUID->"dd4200ec-6dce-4877-9599-98286e8fc3c2"],
Cell[68047, 1378, 2905, 66, 429, "Input",ExpressionUUID->"9ae078ee-425a-4d33-9bd4-18eef41ec0b3"],
Cell[70955, 1446, 622, 14, 32, "Input",ExpressionUUID->"61017c8c-1cda-4bec-9018-6c178c5cf962"]
}, Closed]],
Cell[CellGroupData[{
Cell[71614, 1465, 110, 0, 57, "Section",ExpressionUUID->"a1bb2d26-eaac-4961-b307-7d6f857dcf0c"],
Cell[CellGroupData[{
Cell[71749, 1469, 206, 4, 59, "Subsection",ExpressionUUID->"f9f9637c-01df-4357-9c01-9d4ed8b7c85f"],
Cell[71958, 1475, 7536, 163, 737, "Input",ExpressionUUID->"52bc2e94-520e-4382-96be-84fd161aa85c"],
Cell[79497, 1640, 48140, 926, 3839, "Input",ExpressionUUID->"e41b2265-b8b1-4d68-b2b7-ff160635cae3"]
}, Closed]],
Cell[CellGroupData[{
Cell[127674, 2571, 170, 3, 41, "Subsection",ExpressionUUID->"2b0fb744-630f-41b5-ab52-256a79065ade"],
Cell[CellGroupData[{
Cell[127869, 2578, 231, 4, 49, "Subsubsection",ExpressionUUID->"59f0037f-ed08-4fb6-9d69-7bdd6d9f6998"],
Cell[128103, 2584, 768, 16, 20, "Input",ExpressionUUID->"309439dc-1c74-441b-b591-01e1065dbabe"],
Cell[128874, 2602, 8000, 181, 553, "Input",ExpressionUUID->"4743675b-509d-4645-a8b1-0df358f87def"]
}, Closed]],
Cell[CellGroupData[{
Cell[136911, 2788, 171, 3, 40, "Subsubsection",ExpressionUUID->"ab3bc053-0f1f-48e5-b4a0-104f28dc177e"],
Cell[137085, 2793, 1607, 29, 187, "Input",ExpressionUUID->"c217fd87-d54f-4012-9cc4-e19c2ca0dc74"],
Cell[138695, 2824, 9972, 206, 604, "Input",ExpressionUUID->"bb6cac3a-5301-42bb-a2eb-7e6308ad5d15"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148728, 3037, 162, 3, 73, "Section",ExpressionUUID->"a22f65c3-d485-4bde-a2ce-7ebfa7873fee"],
Cell[CellGroupData[{
Cell[148915, 3044, 263, 4, 59, "Subsection",ExpressionUUID->"f578d3d2-95d1-42a7-a690-dd518177b5b5"],
Cell[149181, 3050, 28819, 512, 1573, "Input",ExpressionUUID->"3fb5be7c-0935-4534-a35d-ab28e8897786"],
Cell[178003, 3564, 1877, 38, 55, "Input",ExpressionUUID->"4f40c0d8-7739-495d-923d-708f88d081cd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179929, 3608, 170, 3, 73, "Section",ExpressionUUID->"c5d5ba60-3e56-46f2-87e9-2ed7be7dcda5"],
Cell[180102, 3613, 2464, 62, 99, "Input",ExpressionUUID->"a8594616-77ed-4fab-bd74-8a91ee3889db"],
Cell[182569, 3677, 704, 17, 32, "Input",ExpressionUUID->"4fd2c932-e57f-4424-9bd2-65b1262fa8d4"],
Cell[183276, 3696, 571, 12, 32, "Input",ExpressionUUID->"97c471d0-3c80-4b4f-bd23-b352ceec5e3c"],
Cell[183850, 3710, 131, 3, 32, "Input",ExpressionUUID->"63c00079-326d-4ea7-afad-95be0ee5e491"],
Cell[183984, 3715, 187, 4, 32, "Input",ExpressionUUID->"cc7203c6-b01b-4cf7-aaf4-7e0770d30ba8"],
Cell[184174, 3721, 255, 6, 32, "Input",ExpressionUUID->"98ead5e3-717c-4934-bfc5-b4585a519e72"],
Cell[184432, 3729, 214, 5, 32, "Input",ExpressionUUID->"8fa2c250-4beb-4b50-bd11-eb9f5e8f729a"],
Cell[184649, 3736, 421, 12, 55, "Input",ExpressionUUID->"e285193c-56cd-4798-81db-15edb95be3de"]
}, Open  ]]
}
]
*)

